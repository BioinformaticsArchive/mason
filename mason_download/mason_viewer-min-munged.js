/*!
   mason_viewer.js

      github.com/yeastrc/mason

  The Mason Viewer is created by calling MasonViewer.createMasonViewer = function ( $rootDiv, requestParams, configParams, callbackFunctionsObj ) {
          where MasonViewer is an object at window.MasonViewer.

   configParams is merged with the following parameters

	MasonViewerPerInstanceRenderOnPage.prototype.configDisplayOptionDefaults = {

		TOP_ROW_OFFSET_FROM_TOP_OF_IMAGE : 2,

		LABEL_FONT_SIZE : 12,
		
		ROW_HEIGHT : 15, //  Adjust the ROW_HEIGHT to accommodate the height of the label

		BLOCK_HEIGHT : 14,  //  Adjust the BLOCK_HEIGHT to accommodate the height of the label


		LABEL_WIDTH : 100,  //  Adjust the LABEL_WIDTH to accommodate the width of the longest label

		ICON_EXPAND_ROW_STARTING_POSITION : 1,
		ICON_EXPAND_ROW_WIDTH : 15,

		ICON_EXPAND_ROW_SPACE_AFTER : 2,

		ROW_TOTALS_BAR_RIGHT_MAX_WIDTH : 30,

		ROW_TOTAL_BLOCK_MINIMUM_SIZE : 1,

		ROW_TOTALS_BAR_RIGHT_SPACE_FROM_MAIN_GRID : 10,

		ROW_TOTALS_BAR_RIGHT_SPACE_FROM_RIGHT_EDGE : 4,


		BORDER_COLOR : "black",

		BORDER_WIDTH : 1,

		FOOTER_HEIGHT : 2,



		//  Tool tip text


		CLICK_TO_CONTRACT_TO_HIDE_INDIVIDUAL_BLOCKS_TOOLTIP_TEXT_PREFIX : "Click to hide individual ",

		CLICK_TO_EXPAND_TO_SHOW_INDIVIDUAL_BLOCKS_TOOLTIP_TEXT_PREFIX : "Click to show individual ",


		blockTypeLabelPlural : "blocks",

		BLOCK_HIGHLIGHT_BORDER_COLOR : "pink",
		BLOCK_HIGHLIGHT_BORDER_WIDTH : 2,


		createCombinedLineOnly : undefined,  //  set to true to only create combined line

		skipCreateCombinedLine : undefined,  //  set to true to skip create combined line

		combinedLineLabel : "Combined",  //  label on left for combined line

		combinedLineTooltipHTML : undefined,  //  tool tip for label on left for combined line

		ALIGNMENT_LINE_COLOR : "black",
		ALIGNMENT_LINE_WIDTH : 2

	};


*/
(function(e,g){var c=function(){};c.prototype.instanceCounter=0;c.prototype.createMasonViewer=function(l,m,h,o){if(l===g||l===null){throw"$rootDiv is missing or null"}if(m===g||m===null){throw"requestParams is missing or null"}if(h===g||h===null){throw"configParams is missing or null"}if(o===g||o===null){throw"callbackFunctionsObj is missing or null"}var j=l.length;if(j!=1){throw"Error calling 'MasonViewer.createMasonViewer': $rootDiv must contain exactly one element"}var n=Modernizr.svg;if(!n){throw"SVG not supported"}this.instanceCounter++;var k={masonViewerMain:this,instanceCounter:this.instanceCounter};var i=new f(l,m,h,o,k);return i};c.prototype.getDataElement=function(){return"MasonViewer"};c.prototype.getProtCovObjectStorageClassName=function(){return"ProtCovObjectStorageClass"};var c=new c();e.MasonViewer=c;"use strict";"use strict";var f=function(n,q,o,j,r){var k=this;var l=n.length;if(l!=1){throw"Error calling 'MasonViewer.createMasonViewer': $rootDiv must contain exactly one element"}var h=r.masonViewerMain;var i='	<div class="'+h.getProtCovObjectStorageClassName()+'" >';$(i).appendTo(n);var m="."+h.getProtCovObjectStorageClassName();var s=n.children(m);if(s.size()===0){throw"Unable to find protCovObjectStorageNode under $rootDiv, protCovObjectStorageNodeSelector = "+m}s.data(h.getDataElement(),this);var t=k.reformatDataToInternalFormat(q);var p=k.computeRepresentation(n,t,q,o);k.renderViewerOnThePage(n,p,q,o,j,r)};f.prototype.renderViewerOnThePage=function(k,m,l,h,n,j){var i=this;this.masonViewerPerInstanceRenderOnPage=new b(k,m,l,h,n,j,i);this.masonViewerPerInstanceRenderOnPage.renderViewerOnThePageMain()};f.prototype.MESSAGE_TYPE_RENDER_ON_PAGE="RENDER_ON_PAGE";f.prototype.hideVerticalDataLines=function(){this.masonViewerPerInstanceRenderOnPage.hideVerticalDataLines()};f.prototype.showVerticalDataLines=function(){this.masonViewerPerInstanceRenderOnPage.showVerticalDataLines()};f.prototype.deleteViewer=function(){this.masonViewerPerInstanceRenderOnPage.deleteViewer()};f.prototype.acceptMessage=function(h){if(h.type===f.prototype.MESSAGE_TYPE_RENDER_ON_PAGE){this.masonViewerPerInstanceRenderOnPage.acceptMessage(h.data)}else{throw"unknown type in message at 'MasonViewerPerInstance.prototype.acceptMessage'.  type: "+h.type}};f.prototype.registerBlockHoverListener=function(h){this.masonViewerPerInstanceRenderOnPage.registerBlockHoverListener(h)};"use strict";f.prototype.computeRepresentation=function(m,t,q,n){var i=this;var r={outputRows:[]};var k=r.outputRows;var s=t;var p=s.rowItems;for(var j=0;j<p.length;j++){var o=p[j];var v=o.blockItems;var u=i.combineOverlapsProteinPositionBased(v);var l=u.outputList;var h={label:o.label,mainLineBlocks:l,blockItems:v,splitAnyEntries:u.splitAnyEntries,inputRowItem:o.inputRowItem,vertLinesItems:o.vertLinesItems};k.push(h)}return r};"use strict";f.prototype.combineOverlaps_Z_compareForSortBlocks=function(i,h){if(i.blockStartPos===h.blockStartPos){return h.blockEndPos-i.blockEndPos}return i.blockStartPos-h.blockStartPos};f.prototype.copyArray=function(h){var i=h.concat();return i};f.prototype.concatArrays=function(i,h){var j=i.concat(h);return j};f.prototype.combineOverlapsProteinPositionBased=function(o){var s=false;var r=true;var j=0;var m=null;var i=this.combineEntriesProteinPositionBased(j,o);while(r){j++;if(j>200){var n="combineOverlapsProteinPositionBased(...):  numTimesSplitAnEntryLoop > 200 so throwing exception.  ";throw n}r=false;m=i;i=[];m.sort(this.combineOverlaps_Z_compareForSortBlocks);var p=-1;while((++p)<m.length){var q=m[p];if(p===(m.length-1)){i.push(q)}else{var t=m[p+1];if(q.blockEndPos<t.blockStartPos){i.push(q)}else{r=true;s=true;if(q.blockStartPos===t.blockStartPos){var h={blockDataItems:this.copyArray(q.blockDataItems),blockStartPos:q.blockStartPos,blockEndPos:t.blockEndPos};var l={blockDataItems:this.copyArray(q.blockDataItems),blockStartPos:t.blockEndPos+1,blockEndPos:q.blockEndPos};i.push(h);i.push(l)}else{var h={blockDataItems:this.copyArray(q.blockDataItems),blockStartPos:q.blockStartPos,blockEndPos:(t.blockStartPos-1)};var l={blockDataItems:this.copyArray(q.blockDataItems),blockStartPos:t.blockStartPos,blockEndPos:q.blockEndPos};
i.push(h);i.push(l)}}}}i=this.combineEntriesProteinPositionBased(j,i)}var k={splitAnyEntries:s,outputList:i};return k};f.prototype.combineEntriesProteinPositionBased=function(l,i){var j=[];var k;i.sort(this.combineOverlaps_Z_compareForSortBlocks);k=-1;while((++k)<i.length){var n=i[k];if(k===(i.length-1)){j.push(n)}else{var h=k;while((++h)<i.length){var m=i[h];if(n.blockStartPos===m.blockStartPos&&n.blockEndPos===m.blockEndPos){k=h;n.blockDataItems=this.concatArrays(n.blockDataItems,m.blockDataItems)}else{break}}j.push(n)}}return j};"use strict";f.prototype.reformatDataToInternalFormat=function(p){var s=p.inputData;if(!s){throw"requestParams.inputData is missing or null"}if(s.maxSequenceLength===g||s.maxSequenceLength===null||typeof s.maxSequenceLength!=="number"){throw"requestParams.inputData.maxSequenceLength is missing or null or is not a number"}var r=[];var n={maxSequenceLength:s.maxSequenceLength,rowItems:r,vertLinesAllRowsItems:s.vertLinesAllRowsItems};var o=s.rowItems;if(!s.rowItems){throw"requestParams.inputData.rowItems is missing or null"}if(s.rowItems.length===0){throw"requestParams.inputData.rowItems is empty"}for(var i=0;i<o.length;i++){var q=o[i];if(q.label===g||q.label===null||q.label===""){throw"requestParams.inputData.rowItems.rowItem[ index ].label is missing or null or is empty for index = "+i}var m=[];var t=q.blockItems;if(!t){throw"requestParams.inputData.rowItems.rowItem[ index ].blockItems is missing or null for index = "+i}for(var h=0;h<t.length;h++){var l=t[h];if(l.startPos===g){throw"requestParams.inputData.rowItems.rowItem[ rowItemsIdx ].blockItem[ blockItemsIdx ] is missing property 'startPos' rowItemsIdx = "+i+", and blockItemsIdx = "+h}if(l.endPos===g){throw"requestParams.inputData.rowItems.rowItem[ rowItemsIdx ].blockItem[ blockItemsIdx ] is missing property 'endPos' rowItemsIdx = "+i+", and blockItemsIdx = "+h}if(l.blockData===g){throw"requestParams.inputData.rowItems.rowItem[ rowItemsIdx ].blockItem[ blockItemsIdx ] is missing property 'blockData' rowItemsIdx = "+i+", and blockItemsIdx = "+h}var j={blockStartPos:l.startPos,blockEndPos:l.endPos,blockDataItems:[l.blockData]};m.push(j)}var k={label:q.label,blockItems:m,inputRowItem:q,vertLinesItems:q.vertLinesItems};r.push(k)}return n};"use strict";var a=function(){this.SVGGroup=g;this.firstOutputRowSVGGroup=g;this.nextProgramaticDataStorageGroupOfRows=g};a.prototype.getSVGGroup=function(){return this.SVGGroup};a.prototype.setSVGGroup=function(h){this.SVGGroup=h};a.prototype.getFirstOutputRowSVGGroup=function(){return this.firstOutputRowSVGGroup};a.prototype.setFirstOutputRowSVGGroup=function(h){this.firstOutputRowSVGGroup=h};a.prototype.getNextProgramaticDataStorageGroupOfRows=function(){return this.nextProgramaticDataStorageGroupOfRows};a.prototype.setNextProgramaticDataStorageGroupOfRows=function(h){this.nextProgramaticDataStorageGroupOfRows=h};var d=function(){this.outputRow=g;this.rowIdx=g;this.rowOffset=g;this.createHiddenBlocksIfNotCreatedCallback=g;this.SVGRowXmainBlocksGROUP=g;this.groupToMoveForExpansion=g;this.hiddenBlocksVisible=false;this.hiddenBlocksForRowSet=g;this.hiddenBlocksHeight=0;this.SVGGroupExpansionIcon=g;this.mainBlocksBoxUnderEachRow=g;this.hiddenBlocksBoxUnderEachRow=g;this.toolTipHTML=g};d.prototype.getCreateHiddenBlocksIfNotCreatedCallback=function(){return this.createHiddenBlocksIfNotCreatedCallback};d.prototype.setCreateHiddenBlocksIfNotCreatedCallback=function(h){this.createHiddenBlocksIfNotCreatedCallback=h};d.prototype.getOutputRow=function(){return this.outputRow};d.prototype.setOutputRow=function(h){this.outputRow=h};d.prototype.getRowOffset=function(){return this.rowOffset};d.prototype.setRowOffset=function(h){this.rowOffset=h};d.prototype.getRowIdx=function(){return this.rowIdx};d.prototype.setRowIdx=function(h){this.rowIdx=h};d.prototype.getSVGRowXmainBlocksGROUP=function(){return this.SVGRowXmainBlocksGROUP};d.prototype.setSVGRowXmainBlocksGROUP=function(h){this.SVGRowXmainBlocksGROUP=h};d.prototype.getGroupToMoveForExpansion=function(){return this.groupToMoveForExpansion};d.prototype.setGroupToMoveForExpansion=function(h){this.groupToMoveForExpansion=h};d.prototype.getHiddenBlocksVisible=function(){return this.hiddenBlocksVisible};d.prototype.setHiddenBlocksVisible=function(h){this.hiddenBlocksVisible=h};d.prototype.getHiddenBlocksForRowSet=function(){return this.hiddenBlocksForRowSet};d.prototype.setHiddenBlocksForRowSet=function(h){this.hiddenBlocksForRowSet=h};d.prototype.getHiddenBlocksHeight=function(){return this.hiddenBlocksHeight};d.prototype.setHiddenBlocksHeight=function(h){this.hiddenBlocksHeight=h};d.prototype.getSVGGroupExpansionIcon=function(){return this.SVGGroupExpansionIcon};d.prototype.setSVGGroupExpansionIcon=function(h){this.SVGGroupExpansionIcon=h};d.prototype.getMainBlocksBoxUnderEachRow=function(){return this.mainBlocksBoxUnderEachRow};d.prototype.setMainBlocksBoxUnderEachRow=function(h){this.mainBlocksBoxUnderEachRow=h};d.prototype.getHiddenBlocksBoxUnderEachRow=function(){return this.hiddenBlocksBoxUnderEachRow};d.prototype.setHiddenBlocksBoxUnderEachRow=function(h){this.hiddenBlocksBoxUnderEachRow=h};d.prototype.getToolTipHTML=function(){return this.toolTipHTML};d.prototype.setToolTipHTML=function(h){this.toolTipHTML=h};"use strict";var b=function(j,l,k,h,n,i,m){this.constructorParams={$rootDiv:j,data:l,requestParams:k,configParams:h,callbackFunctionsObj:n,internalParams:i,objectThisMasonViewerPerInstance:m};this.configDisplayOptions={};$.extend(this.configDisplayOptions,b.prototype.configDisplayOptionDefaults,h);this.configDisplayOptions.LABEL_STARTING_POSITION=this.configDisplayOptions.ICON_EXPAND_ROW_STARTING_POSITION+this.configDisplayOptions.ICON_EXPAND_ROW_WIDTH+this.configDisplayOptions.ICON_EXPAND_ROW_SPACE_AFTER;this.configDisplayOptions.MAIN_BOX_STARTING_POSITION=this.configDisplayOptions.LABEL_STARTING_POSITION+this.configDisplayOptions.LABEL_WIDTH;this.configDisplayOptions.CLICK_TO_CONTRACT_TO_HIDE_INDIVIDUAL_BLOCKS_TOOLTIP_TEXT=this.configDisplayOptions.CLICK_TO_CONTRACT_TO_HIDE_INDIVIDUAL_BLOCKS_TOOLTIP_TEXT_PREFIX+this.configDisplayOptions.blockTypeLabelPlural;
this.configDisplayOptions.CLICK_TO_EXPAND_TO_SHOW_INDIVIDUAL_BLOCKS_TOOLTIP_TEXT=this.configDisplayOptions.CLICK_TO_EXPAND_TO_SHOW_INDIVIDUAL_BLOCKS_TOOLTIP_TEXT_PREFIX+this.configDisplayOptions.blockTypeLabelPlural;this.GLOBALS={masonViewerSVG:g,overallWidth:g,sequenceWidth:g,sequenceMultiplier:g,rowsPerGroup:g,viewerHeightInsideTheBox:g,arrayOfcurrentSVGgroupOfRowXandBelow:[],setSVGVerticalDataLines:g,setSVGVerticalDataFullHeightLines:g,showVerticalDataLines:true};this.GLOBALS.MAIN_BOX_STARTING_POSITION=this.configDisplayOptions.MAIN_BOX_STARTING_POSITION};b.prototype.renderViewerOnThePageMain=function(){this.createSVG_Lib_Instance();this.putDataOnThePageMain();this.resizeOverallImageLength()};b.prototype.createSVG_Lib_Instance=function(){var i=this.constructorParams.$rootDiv.width();var l=this.constructorParams.$rootDiv[0];try{this.GLOBALS.masonViewerSVG=SVG(l).size(i,5)}catch(k){var j=k.stack;throw"Exception creating SVG.  "+j}this.GLOBALS.setSVGVerticalDataLines=this.GLOBALS.masonViewerSVG.set();this.GLOBALS.overallWidth=i;this.GLOBALS.rowTotalsBarRightStartingPoint=i-(this.configDisplayOptions.ROW_TOTALS_BAR_RIGHT_MAX_WIDTH+this.configDisplayOptions.ROW_TOTALS_BAR_RIGHT_SPACE_FROM_RIGHT_EDGE);this.GLOBALS.sequenceWidth=i-(this.configDisplayOptions.LABEL_STARTING_POSITION+this.configDisplayOptions.LABEL_WIDTH)-(this.configDisplayOptions.ROW_TOTALS_BAR_RIGHT_MAX_WIDTH+this.configDisplayOptions.ROW_TOTALS_BAR_RIGHT_SPACE_FROM_MAIN_GRID+this.configDisplayOptions.ROW_TOTALS_BAR_RIGHT_SPACE_FROM_RIGHT_EDGE);this.GLOBALS.sequenceMultiplier=this.GLOBALS.sequenceWidth/(this.constructorParams.requestParams.inputData.maxSequenceLength),this.GLOBALS.leftLineX=this.configDisplayOptions.MAIN_BOX_STARTING_POSITION-0.5;this.GLOBALS.rightLineX=this.configDisplayOptions.MAIN_BOX_STARTING_POSITION+this.GLOBALS.sequenceWidth+0.5;var h=this.constructorParams.data.outputRows.length;this.GLOBALS.rowsPerGroup=Math.floor(Math.sqrt(h));if(this.GLOBALS.rowsPerGroup<b.prototype.CONSTANTS.MIN_MAX_VALUES.MINIMUM_ROWS_PER_GROUP){this.GLOBALS.rowsPerGroup=b.prototype.CONSTANTS.MIN_MAX_VALUES.MINIMUM_ROWS_PER_GROUP}if(b.prototype.CONSTANTS.MIN_MAX_VALUES.MAXIMUM_ROWS_PER_GROUP){if(this.GLOBALS.rowsPerGroup>b.prototype.CONSTANTS.MIN_MAX_VALUES.MAXIMUM_ROWS_PER_GROUP){this.GLOBALS.rowsPerGroup=b.prototype.CONSTANTS.MIN_MAX_VALUES.MAXIMUM_ROWS_PER_GROUP}}};b.prototype.putDataOnThePageMain=function(){var o=this.constructorParams.data.outputRows;this.add_callbackDataStorage_ToElementsIn_outputRows(o);var l=this.GLOBALS.masonViewerSVG.group();l.attr("label","SVGrootGroupInsideBoundingBox");var k=this.GLOBALS.masonViewerSVG.group();this.setupGroupOfRows(k);var m=this.getProgramaticDataStorageFromSVG_js_Item(k);l.add(k);var n=this.GLOBALS.masonViewerSVG.group();this.setupRootGroupForEachRow(n);var j=this.getProgramaticDataStorageFromSVG_js_Item(n);j._type="currentSVGgroupOfRowXandBelow";j._attachedTo=n;k.add(n);m.setFirstOutputRowSVGGroup(n);var v=0;if((o.length>1||this.configDisplayOptions.createCombinedLineOnly)&&!this.configDisplayOptions.skipCreateCombinedLine){this.processCombinedRow(o,0,n,j);t=this.GLOBALS.masonViewerSVG.group();t.attr("label","nextSVGgroupOfRowXandBelow");n.add(t);j.setGroupToMoveForExpansion(t);n=t;this.setupRootGroupForEachRow(n);j=this.getProgramaticDataStorageFromSVG_js_Item(n);j._type="currentSVGgroupOfRowXandBelow";j._attachedTo=n;v=1}this.precomputeValuesOnCreateForMainRows(o);var u=0;if(this.configDisplayOptions.createCombinedLineOnly!==true){u=o.length;for(var i=0;i<o.length;i++){var q=i+v;var h=o[i];n.data("row-rowIdx",i);var j=this.getProgramaticDataStorageFromSVG_js_Item(n);j._type="currentSVGgroupOfRowXandBelow";j._attachedTo=n;j.setOutputRow(h);j.setRowIdx(i);j.setRowOffset(q);var s=this.GLOBALS.masonViewerSVG.group();n.add(s);s.attr("label","SVGRowXmainBlocksGROUP");j.setSVGRowXmainBlocksGROUP(s);this.addBoxUnderEachRowForMouseOver(s,j,q);this.processLabelForRow(h,n,q);var w=h.splitAnyEntries;if(w){this.createMainLineHiddenBlocksIfNotCreatedCallbackCreator(h,n,j,q);this.createHiddenBlocksExpansionIcon(this.configDisplayOptions.CLICK_TO_EXPAND_TO_SHOW_INDIVIDUAL_BLOCKS_TOOLTIP_TEXT,s,q,j)}this.processMainLineBlocksForRow(h,n,s,q);this.processRowTotalBlockForRow(h,n,q);var t=this.GLOBALS.masonViewerSVG.group();t.attr("label","nextSVGgroupOfRowXandBelow");this.setupRootGroupForEachRow(t);if(i>0&&(i%this.GLOBALS.rowsPerGroup===0)){var p=this.GLOBALS.masonViewerSVG.group();this.setupGroupOfRows(p);var r=this.getProgramaticDataStorageFromSVG_js_Item(p);k.add(p);m.setNextProgramaticDataStorageGroupOfRows(r);k=p;m=r;k.add(t);m.setFirstOutputRowSVGGroup(t)}else{n.add(t);j.setGroupToMoveForExpansion(t)}n=t}}this.addFullHeightLines();this.addBottomLineAndBottomScale(n,u);this.addTopLine(l)};b.prototype.addTopLine=function(h){var i=this.GLOBALS.masonViewerSVG.line(this.GLOBALS.leftLineX-0.5,this.configDisplayOptions.TOP_ROW_OFFSET_FROM_TOP_OF_IMAGE,this.GLOBALS.rightLineX+0.5,this.configDisplayOptions.TOP_ROW_OFFSET_FROM_TOP_OF_IMAGE).stroke({color:this.configDisplayOptions.BORDER_COLOR,width:this.configDisplayOptions.BORDER_WIDTH});h.add(i)};b.prototype.addBottomLineAndBottomScale=function(k,j){var m=(j+1)*this.configDisplayOptions.ROW_HEIGHT;if(j<=1||this.configDisplayOptions.skipCreateCombinedLine){m=(j)*this.configDisplayOptions.ROW_HEIGHT}if(this.configDisplayOptions.createCombinedLineOnly){m=(j+1)*this.configDisplayOptions.ROW_HEIGHT}var l=this.GLOBALS.masonViewerSVG.text("1");var h=(m)+(this.configDisplayOptions.ROW_HEIGHT/2);h=h+this.configDisplayOptions.TOP_ROW_OFFSET_FROM_TOP_OF_IMAGE;this.setSVGTextPosition({textSVG:l,x:this.GLOBALS.leftLineX,y:h});var o=this.constructorParams.requestParams.inputData.maxSequenceLength+"";var i=this.GLOBALS.masonViewerSVG.text(o);this.clearStyleAnd_dy_OnSVGtextItem(i);var h=(m)+(this.configDisplayOptions.ROW_HEIGHT/2);h=h+this.configDisplayOptions.TOP_ROW_OFFSET_FROM_TOP_OF_IMAGE;this.setSVGTextPosition({textSVG:i,x:this.GLOBALS.rightLineX,y:h,otherAttrsToSet:[{attrName:"text-anchor",attrValue:"end"}]});
var n=this.GLOBALS.masonViewerSVG.line(this.GLOBALS.leftLineX-0.5,(m)+this.configDisplayOptions.TOP_ROW_OFFSET_FROM_TOP_OF_IMAGE,this.GLOBALS.rightLineX+0.5,(m)+this.configDisplayOptions.TOP_ROW_OFFSET_FROM_TOP_OF_IMAGE).stroke({color:this.configDisplayOptions.BORDER_COLOR,width:this.configDisplayOptions.BORDER_WIDTH});k.add(l);k.add(i);k.add(n)};b.prototype.resizeOverallImageLength=function(){var m=this.constructorParams.data.outputRows.length;if(m>1&&(!this.configDisplayOptions.skipCreateCombinedLine)){m+=1}if(this.configDisplayOptions.createCombinedLineOnly){m=1}var n=this.configDisplayOptions.ROW_HEIGHT*m;var o=0;for(var j=0;j<this.GLOBALS.arrayOfcurrentSVGgroupOfRowXandBelow.length;j++){var l=this.GLOBALS.arrayOfcurrentSVGgroupOfRowXandBelow[j];var k=this.getProgramaticDataStorageFromSVG_js_Item(l);if(k.getHiddenBlocksVisible()){o+=k.getHiddenBlocksHeight()}}var i=n+o;this.GLOBALS.viewerHeightInsideTheBox=i;var h=this.configDisplayOptions.TOP_ROW_OFFSET_FROM_TOP_OF_IMAGE+i+this.configDisplayOptions.ROW_HEIGHT+this.configDisplayOptions.FOOTER_HEIGHT;this.GLOBALS.masonViewerSVG.size(this.GLOBALS.overallWidth,h);this.updateFullHeightLines()};b.prototype.showHideAllVerticalDataLinesPer_GLOBALS_showVerticalDataLines=function(){if(this.GLOBALS.showVerticalDataLines){this.constructorParams.objectThisMasonViewerPerInstance.showVerticalDataLines()}else{this.constructorParams.objectThisMasonViewerPerInstance.hideVerticalDataLines()}};"use strict";b.prototype.configDisplayOptionDefaults={TOP_ROW_OFFSET_FROM_TOP_OF_IMAGE:2,LABEL_FONT_SIZE:12,ROW_HEIGHT:15,BLOCK_HEIGHT:14,LABEL_WIDTH:100,ICON_EXPAND_ROW_STARTING_POSITION:1,ICON_EXPAND_ROW_WIDTH:15,ICON_EXPAND_ROW_SPACE_AFTER:2,ROW_TOTALS_BAR_RIGHT_MAX_WIDTH:30,ROW_TOTAL_BLOCK_MINIMUM_SIZE:1,ROW_TOTALS_BAR_RIGHT_SPACE_FROM_MAIN_GRID:10,ROW_TOTALS_BAR_RIGHT_SPACE_FROM_RIGHT_EDGE:4,BORDER_COLOR:"black",BORDER_WIDTH:1,FOOTER_HEIGHT:2,CLICK_TO_CONTRACT_TO_HIDE_INDIVIDUAL_BLOCKS_TOOLTIP_TEXT_PREFIX:"Click to hide individual ",CLICK_TO_EXPAND_TO_SHOW_INDIVIDUAL_BLOCKS_TOOLTIP_TEXT_PREFIX:"Click to show individual ",blockTypeLabelPlural:"blocks",BLOCK_HIGHLIGHT_BORDER_COLOR:"pink",BLOCK_HIGHLIGHT_BORDER_WIDTH:2,createCombinedLineOnly:g,skipCreateCombinedLine:g,combinedLineLabel:"Combined",combinedLineTooltipHTML:g,ALIGNMENT_LINE_COLOR:"black",ALIGNMENT_LINE_WIDTH:2};"use strict";b.prototype.deleteViewer=function(){var h=this.constructorParams.$rootDiv.find("svg");h.remove()};b.prototype.hideVerticalDataLines=function(){this.GLOBALS.setSVGVerticalDataLines.hide();this.GLOBALS.showVerticalDataLines=false};b.prototype.showVerticalDataLines=function(){this.GLOBALS.setSVGVerticalDataLines.show();this.GLOBALS.showVerticalDataLines=true};b.prototype.MESSAGE_TYPE_REMOVE_ALIGNMENTS="REMOVE_ALIGNMENTS";b.prototype.MESSAGE_TYPE_ADD_ALIGNMENTS="ADD_ALIGNMENTS";b.prototype.acceptMessage=function(h){if(h.type===b.prototype.MESSAGE_TYPE_REMOVE_ALIGNMENTS){this.removeAlignmentLines(h.data)}else{if(h.type===b.prototype.MESSAGE_TYPE_ADD_ALIGNMENTS){this.addAlignmentLines(h.data)}else{throw"unknown type in message at 'MasonViewerPerInstanceRenderOnPage.prototype.acceptMessage'.  type: "+h.type}}};b.prototype.removeAlignmentLines=function(h){if(this.GLOBALS.setSVGAlignmentLines){this.GLOBALS.setSVGAlignmentLines.each(function(j){this.remove()});this.GLOBALS.setSVGAlignmentLines.clear()}};b.prototype.addAlignmentLines=function(k){var j=this.GLOBALS.viewerHeightInsideTheBox;this.GLOBALS.setSVGAlignmentLines=this.GLOBALS.masonViewerSVG.set();var l=k.linePosArray;for(var o=0;o<l.length;o++){var s=l[o];var n=this.positionCharPositionToPixel(s);var h=n+this.GLOBALS.MAIN_BOX_STARTING_POSITION;var i=this.configDisplayOptions.ALIGNMENT_LINE_WIDTH/2;var r=h-i;var q=this.configDisplayOptions.TOP_ROW_OFFSET_FROM_TOP_OF_IMAGE;var p=this.configDisplayOptions.TOP_ROW_OFFSET_FROM_TOP_OF_IMAGE+j;var m=this.GLOBALS.masonViewerSVG.line(r,q,r,p).stroke({color:this.configDisplayOptions.ALIGNMENT_LINE_COLOR,width:this.configDisplayOptions.ALIGNMENT_LINE_WIDTH});this.GLOBALS.setSVGAlignmentLines.add(m)}};b.prototype.registerBlockHoverListener=function(i){var h=i.hoverListener;if(!this.blockHoverCallList){this.blockHoverCallList=[]}this.blockHoverCallList.push(h)};b.prototype.callListenersForBlockMouseEnter=function(j){if(this.blockHoverCallList){var n=j.blockInfo;var l=n.startPos;var h=n.endPos;var o=this.limitCharPositionMaxSeqLength(l-0.5);var m=this.limitCharPositionMaxSeqLength(h+0.5);var i={linePosArray:[o,m]};var q=this.createAddAlignmentsMessage(i);for(var p=0;p<this.blockHoverCallList.length;p++){var k=this.blockHoverCallList[p];k.passMessage(q)}}};b.prototype.callListenersForBlockMouseLeave=function(k){if(this.blockHoverCallList){var i=this.createRemoveAlignmentsMessage({});for(var j=0;j<this.blockHoverCallList.length;j++){var h=this.blockHoverCallList[j];h.passMessage(i)}}};b.prototype.createAddAlignmentsMessage=function(i){var j={type:b.prototype.MESSAGE_TYPE_ADD_ALIGNMENTS,data:i};var h=this.createMessage(j);return h};b.prototype.createRemoveAlignmentsMessage=function(i){var j={type:b.prototype.MESSAGE_TYPE_REMOVE_ALIGNMENTS,data:i};var h=this.createMessage(j);return h};b.prototype.createMessage=function(i){var h={type:f.prototype.MESSAGE_TYPE_RENDER_ON_PAGE,data:i};return h};"use strict";b.prototype.animateTransformY=function(j){var k=j.SVGoGroupToMove;var h=j.yToTransformTo;var i=j.functionToRunAfterAnimate;k.animate({duration:150,ease:"-",delay:0}).transform({y:h}).after(i)};"use strict";b.prototype.CONSTANTS={MIN_MAX_VALUES:{MINIMUM_ROWS_PER_GROUP:20},CLASSES:{PROT_COV_VIEWER_GROUP_OR_ROWS:"prot_cov_viewer_group_of_rows",PROT_COV_VIEWER_GROUP_ROW_MAIN:"prot_cov_viewer_group_row_main",PROT_COV_VIEWER_GROUP_ROW_VISIBLE:"prot_cov_viewer_group_row_visible"},JQUERY_DATA_LABELS:{JQUERY_DATA_LABEL_PROGRAMATIC:"programatic"}};"use strict";b.prototype.addFullHeightLines=function(){var j=this;var h=0;var w=this.constructorParams.requestParams.inputData.vertLinesAllRowsItems;if(w&&w.length>0&&j.constructorParams.callbackFunctionsObj.allRowsVerticalLines_callbackFunctions&&j.constructorParams.callbackFunctionsObj.allRowsVerticalLines_callbackFunctions.getColorForLine){this.GLOBALS.setSVGVerticalDataFullHeightLines=this.GLOBALS.masonViewerSVG.set();
for(var t=0;t<w.length;t++){var l=w[t];var r=l.linePos;var k=l.vertLineData;if(k===g||k===null){throw" inputData.vertLinesAllRowsItems[ vertLinesAllRowsItemsIdx ].vertLineData is empty or null for vertLinesAllRowsItemsIdx = "+t}if(r===g||r===null){throw" inputData.vertLinesAllRowsItems[ vertLinesAllRowsItemsIdx ].linePos is empty or null for vertLinesAllRowsItemsIdx = "+t}l.callbackDataStorage={};if(j.constructorParams.callbackFunctionsObj.allRowsVerticalLines_callbackFunctions&&j.constructorParams.callbackFunctionsObj.allRowsVerticalLines_callbackFunctions.precomputeValuesOnCreate){var u={vertLineData:k,linePos:r,callbackDataStorage:l.callbackDataStorage};j.constructorParams.callbackFunctionsObj.allRowsVerticalLines_callbackFunctions.precomputeValuesOnCreate(u)}var n=this.positionCharPositionToPixel(r);var q=n+this.configDisplayOptions.MAIN_BOX_STARTING_POSITION;var p=this.configDisplayOptions.TOP_ROW_OFFSET_FROM_TOP_OF_IMAGE;var o=this.configDisplayOptions.TOP_ROW_OFFSET_FROM_TOP_OF_IMAGE+this.configDisplayOptions.ROW_HEIGHT;var s={vertLineData:k,callbackDataStorage:l.callbackDataStorage,forHiddenLines:false};var v=j.constructorParams.callbackFunctionsObj.allRowsVerticalLines_callbackFunctions.getColorForLine(s);this.isValidColor(v);var m=this.GLOBALS.masonViewerSVG.line(q,p,q,o).stroke({color:v,width:this.configDisplayOptions.BORDER_WIDTH});this.GLOBALS.setSVGVerticalDataLines.add(m);this.GLOBALS.setSVGVerticalDataFullHeightLines.add(m);this.addProgramaticDataStorageToSVG_js_Item(m);m.data("row-rowIdx",h);m.data("placement","primary row lines");m.data("block-id",l.id);var i={verticalLineSVG:m,lineData:l,callbackFunctions:j.constructorParams.callbackFunctionsObj.allRowsVerticalLines_callbackFunctions};this.attachMouseOverVerticalLine(i)}}};b.prototype.updateFullHeightLines=function(i){if(this.GLOBALS.setSVGVerticalDataFullHeightLines){var h=this.configDisplayOptions.TOP_ROW_OFFSET_FROM_TOP_OF_IMAGE+this.GLOBALS.viewerHeightInsideTheBox;this.GLOBALS.setSVGVerticalDataFullHeightLines.each(function(j){this.attr("y2",h)})}};"use strict";b.prototype.convertBlockColorTo_SVGJS_FillColor=function(i){if(i===g||i===null){throw"ERROR: colorForBlock === undefined || colorForBlock === null"}if(typeof i=="string"||i instanceof String){this.isValidColor(i);return i}else{var h=this.roundAndValidateColor(i);var j={r:h.red,g:h.green,b:h.blue};return j}throw"Code error in 'convertBlockColorTo_SVGJS_FillColor', should have returned by this point: value passed is: "+i};b.prototype.isValidColor=function(h){if(typeof h=="string"||h instanceof String){}else{throw"'isValidColor' only valid for string input.  colorParam: "+h}if(/^#[a-f0-9]{6}$/i.test(h)){return}throw"color is a string but is not a valid hex color with 6 positions  (e.g. #ff0066): value passed is: "+h};b.prototype.roundAndValidateColor=function(i){if(i===g||i===null){throw"ERROR: colorForBlock === undefined || colorForBlock === null"}if(i.red===g||i.red===null){throw"ERROR: colorForBlock.red === undefined || colorForBlock.red === null"}if(i.green===g||i.green===null){throw"ERROR: colorForBlock.green === undefined || colorForBlock.green === null"}if(i.blue===g||i.blue===null){throw"ERROR: colorForBlock.blue === undefined || colorForBlock.blue === null"}var h={red:Math.round(i.red),green:Math.round(i.green),blue:Math.round(i.blue)};if(h.red<0||h.red>255){throw"colorForBlock.red calculated < 0 or > 255, is = "+h.red}if(h.green<0||h.green>255){throw"colorForBlock.green calculated < 0 or > 255, is = "+h.green}if(h.blue<0||h.blue>255){throw"colorForBlock.blue calculated < 0 or > 255, is = "+h.blue}return h};b.prototype.getIdForSVG_js_item=function(h){var i=h.attr("id");return i};b.prototype.getJQueryObjForRawSVGFromSVG_js_item=function(h){if(h===g||h===null){throw"ERROR: SVG_js_item === undefined || SVG_js_item === null"}var i=$(h.node);return i};b.prototype.getSVG_js_itemForJQueryObj=function(i){if(i===g||i===null){throw"ERROR: $jQueryObj === undefined || $jQueryObj === null"}if(i.length===0){throw"ERROR: $jQueryObj.length === 0"}var h=i[0].instance;return h};b.prototype.addProgramaticDataStorageGroupOfRowsToJQueryItem=function(h){var i=new a();h.data(b.prototype.CONSTANTS.JQUERY_DATA_LABELS.JQUERY_DATA_LABEL_PROGRAMATIC,i);i.$item=h;return i};b.prototype.getProgramaticDataStorageGroupOfRowsFromJQueryItem=function(h){var i=h.data(b.prototype.CONSTANTS.JQUERY_DATA_LABELS.JQUERY_DATA_LABEL_PROGRAMATIC);if(i===g){}return i};b.prototype.addProgramaticDataStorageGroupOfRowsToSVG_js_Item=function(i){var h=this.getJQueryObjForRawSVGFromSVG_js_item(i);return this.addProgramaticDataStorageGroupOfRowsToJQueryItem(h)};b.prototype.getProgramaticDataStorageGroupOfRowsFromSVG_js_Item=function(j){var i=this.getJQueryObjForRawSVGFromSVG_js_item(j);var h=this.getProgramaticDataStorageGroupOfRowsFromJQueryItem(i);return h};b.prototype.addProgramaticDataStorageToJQueryItem=function(h){var i=new d();h.data(b.prototype.CONSTANTS.JQUERY_DATA_LABELS.JQUERY_DATA_LABEL_PROGRAMATIC,i);i.$item=h;return i};b.prototype.getProgramaticDataStorageFromJQueryItem=function(h){var i=h.data(b.prototype.CONSTANTS.JQUERY_DATA_LABELS.JQUERY_DATA_LABEL_PROGRAMATIC);if(i===g){}return i};b.prototype.addProgramaticDataStorageToSVG_js_Item=function(i){var h=this.getJQueryObjForRawSVGFromSVG_js_item(i);return this.addProgramaticDataStorageToJQueryItem(h)};b.prototype.getProgramaticDataStorageFromSVG_js_Item=function(j){var i=this.getJQueryObjForRawSVGFromSVG_js_item(j);var h=this.getProgramaticDataStorageFromJQueryItem(i);return h};b.prototype.set_class_directly_OnSVGItem_using_jQuery=function(i,j){var h=this.getJQueryObjForRawSVGFromSVG_js_item(i);h.attr("class",j)};b.prototype.set_attr_directly_OnSVGtextItem_using_jQuery=function(l,j,k){var i=this.getJQueryObjForRawSVGFromSVG_js_item(l);i.attr(j,k);var h=i.children("tspan");h.attr(j,k)};b.prototype.clearStyleAnd_dy_OnSVGtextItem=function(j){var i=this.getJQueryObjForRawSVGFromSVG_js_item(j);i.attr("style","");i.attr("dy","");var h=i.children("tspan");
h.attr("style","");h.attr("dy","")};b.prototype.attachToolTipToJqueryHtmlNode=function(i,j,h){i.mouseenter(function(k){var l=j();Tip(l,DELAY,0);if(h&&h.mouseenter){h.mouseenter(this)}});i.mouseleave(function(k){UnTip();if(h&&h.mouseleave){h.mouseleave(this)}})};b.prototype.attachMouseOverVerticalLine=function(l){var i=l.verticalLineSVG;var m=l.lineData;var k=l.callbackFunctions;var j=this.getJQueryObjForRawSVGFromSVG_js_item(i);var h={vertLineData:m.vertLineData,linePos:m.linePos,callbackDataStorage:m.callbackDataStorage};this.attachToolTipToJqueryHtmlNode(j,function(p,o){var n=k.getLinesToolTipText(h);$(p).html(n);return n})};b.prototype.get$groupOfRowsFor$currentElement=function(i){var h="g."+b.prototype.CONSTANTS.CLASSES.PROT_COV_VIEWER_GROUP_OR_ROWS;var j=i.parent().closest(h);if(j.length===0){throw"Unable to find group of rows element using selector '"+h+"'."}return j};b.prototype.get$rowMainGroupFor$currentElement=function(i){var j="g."+b.prototype.CONSTANTS.CLASSES.PROT_COV_VIEWER_GROUP_ROW_MAIN;var h=i.parent().closest(j);if(h.length===0){throw"Unable to find main group element using selector '"+j+"'."}return h};b.prototype.attachClickShowHideToggleHiddenBlocksRow=function(i){var j=this;var h=this.getJQueryObjForRawSVGFromSVG_js_item(i);h.click(function(k,l){j.clickShowHideToggleHiddenBlocksRow(k,l,this)})};b.prototype.setSVGTextPosition=function(i){var k=i.textSVG;var h=i.x;var o=i.y;var j=i.otherAttrsToSet;var n=i.additionalStyle;if(n===g||n===null){n=""}k.move(h,o);this.set_attr_directly_OnSVGtextItem_using_jQuery(k,"dy",".35em");this.set_attr_directly_OnSVGtextItem_using_jQuery(k,"style","font-size:"+this.configDisplayOptions.LABEL_FONT_SIZE+"px;font-family:Helvetica, Arial, sans-serif"+n);if(j!==g&&j!==null&&j instanceof Array&&j.length>0){for(var m=0;m<j.length;m++){var l=j[m];this.set_attr_directly_OnSVGtextItem_using_jQuery(k,l.attrName,l.attrValue)}}};b.prototype.add_callbackDataStorage_ToElementsIn_outputRows=function(i){for(var h=0;h<i.length;h++){var j=i[h];j.callbackDataStorage={}}};b.prototype.setupGroupOfRows=function(h){this.set_class_directly_OnSVGItem_using_jQuery(h,b.prototype.CONSTANTS.CLASSES.PROT_COV_VIEWER_GROUP_OR_ROWS);var i=this.addProgramaticDataStorageGroupOfRowsToSVG_js_Item(h);i.setSVGGroup(h);return i};b.prototype.setupRootGroupForEachRow=function(h){this.GLOBALS.arrayOfcurrentSVGgroupOfRowXandBelow.push(h);this.set_class_directly_OnSVGItem_using_jQuery(h,b.prototype.CONSTANTS.CLASSES.PROT_COV_VIEWER_GROUP_ROW_MAIN);return this.addProgramaticDataStorageToSVG_js_Item(h)};b.prototype.highlightBoxUnderEachRow=function(m){var n=this;var k=$(m.node);var j=this.get$rowMainGroupFor$currentElement(k);var l=n.getProgramaticDataStorageFromJQueryItem(j);var h=l.getMainBlocksBoxUnderEachRow();if(l.getHiddenBlocksVisible()){h=l.getHiddenBlocksBoxUnderEachRow()}if(h===g){return}var i=$(h.node);i.css({stroke:"lightgreen","stroke-width":5})};b.prototype.unhighlightBoxUnderEachRow=function(m){if(m===g){return}var k=$(m.node);var j=this.get$rowMainGroupFor$currentElement(k);var l=this.getProgramaticDataStorageFromJQueryItem(j);if(l===g){return}var h=l.getMainBlocksBoxUnderEachRow();if(l.getHiddenBlocksVisible()){h=l.getHiddenBlocksBoxUnderEachRow()}if(h===g){return}var i=$(h.node);i.css({stroke:"black","stroke-width":0})};b.prototype.addBoxUnderEachRowForMouseOver=function(j,l,k){var m=this;var n=(k*this.configDisplayOptions.ROW_HEIGHT);n=n+this.configDisplayOptions.TOP_ROW_OFFSET_FROM_TOP_OF_IMAGE;var i=this.GLOBALS.masonViewerSVG.rect(this.GLOBALS.sequenceWidth,this.configDisplayOptions.BLOCK_HEIGHT);j.add(i);l.setMainBlocksBoxUnderEachRow(i);i.attr({fill:{r:255,g:255,b:255},stroke:{r:0,g:0,b:0},"stroke-width":0,"fill-opacity":0});i.attr("data-placement","mainBlocksBoxUnderEachMainRow");i.attr("rowIdx",k);i.move(this.configDisplayOptions.MAIN_BOX_STARTING_POSITION,n);this.addProgramaticDataStorageToSVG_js_Item(i);var h=this.getJQueryObjForRawSVGFromSVG_js_item(i);h.hover(function(o){m.highlightBoxUnderEachRow(this.instance)},function(o){m.unhighlightBoxUnderEachRow(this.instance)})};b.prototype.addHiddenOrTotalsBlocksBoxUnderEachRowForMouseOver=function(p,h,l,m,i){var k=this;var o=(i*this.configDisplayOptions.ROW_HEIGHT);o=o+this.configDisplayOptions.TOP_ROW_OFFSET_FROM_TOP_OF_IMAGE;var n=this.GLOBALS.masonViewerSVG.rect(this.GLOBALS.sequenceWidth,h);l.add(n);m.setHiddenBlocksBoxUnderEachRow(n);n.attr({fill:{r:255,g:255,b:255},stroke:{r:0,g:0,b:0},"stroke-width":0,"fill-opacity":0});n.attr("data-placement",p);n.attr("rowIdx",i);n.move(this.configDisplayOptions.MAIN_BOX_STARTING_POSITION,o);this.addProgramaticDataStorageToSVG_js_Item(n);var j=this.getJQueryObjForRawSVGFromSVG_js_item(n);j.hover(function(q){k.highlightBoxUnderEachRow(this.instance)},function(q){k.unhighlightBoxUnderEachRow(this.instance)});n.hide()};b.prototype.addHiddenBlocksBoxUnderEachRowForMouseOver=function(k,h,j,i){this.addHiddenOrTotalsBlocksBoxUnderEachRowForMouseOver("hiddenBlocksBoxUnderEachMainRow",k,h,j,i)};b.prototype.addTotalsBlocksBoxUnderEachRowForMouseOver=function(k,h,j,i){this.addHiddenOrTotalsBlocksBoxUnderEachRowForMouseOver("TotalsBlocksBoxUnderCombinedRow",k,h,j,i)};b.prototype.createHiddenBlocksContractionIcon=function(n,h,l,i){var j=this.GLOBALS.masonViewerSVG.group();h.add(j);j.attr("label","SVGGroupContractionIcon");this.attachClickShowHideToggleHiddenBlocksRow(j);j.attr("CreatedBy","createHiddenBlocksContractionIcon");var o=(l*this.configDisplayOptions.ROW_HEIGHT)+(this.configDisplayOptions.ROW_HEIGHT/4)+this.configDisplayOptions.TOP_ROW_OFFSET_FROM_TOP_OF_IMAGE;var k=this.GLOBALS.masonViewerSVG.rect(this.configDisplayOptions.ICON_EXPAND_ROW_WIDTH/2,this.configDisplayOptions.ROW_HEIGHT/2);k.attr({fill:{r:255,g:255,b:255},stroke:{r:255,g:0,b:0},"fill-opacity":0});k.move(this.configDisplayOptions.ICON_EXPAND_ROW_STARTING_POSITION+this.configDisplayOptions.ICON_EXPAND_ROW_WIDTH/4,o);this.attachToolTipToJqueryHtmlNode($(k.node),function(q,p){$(q).html(n);return n});var m=this.GLOBALS.masonViewerSVG.line(this.configDisplayOptions.ICON_EXPAND_ROW_STARTING_POSITION+(this.configDisplayOptions.ICON_EXPAND_ROW_WIDTH/4)+2,o+this.configDisplayOptions.ROW_HEIGHT/4,this.configDisplayOptions.ICON_EXPAND_ROW_STARTING_POSITION+this.configDisplayOptions.ICON_EXPAND_ROW_WIDTH-(this.configDisplayOptions.ICON_EXPAND_ROW_WIDTH/2)+(this.configDisplayOptions.ICON_EXPAND_ROW_WIDTH/4)-2,o+this.configDisplayOptions.ROW_HEIGHT/4).stroke({color:"#f06",width:1});
this.attachToolTipToJqueryHtmlNode($(m.node),function(q,p){$(q).html(n);return n});k.attr("cursor","pointer");m.attr("cursor","pointer");j.add(k);j.add(m)};b.prototype.createHiddenBlocksExpansionIcon=function(l,k,h,i){var j=this.GLOBALS.masonViewerSVG.group();j.attr("label","SVGGroupExpansionIcon");var o=this.GLOBALS.masonViewerSVG.set();k.add(j);this.attachClickShowHideToggleHiddenBlocksRow(j);i.setSVGGroupExpansionIcon(o);var m=(h*this.configDisplayOptions.ROW_HEIGHT)+(this.configDisplayOptions.ROW_HEIGHT/4)+this.configDisplayOptions.TOP_ROW_OFFSET_FROM_TOP_OF_IMAGE;var q=this.GLOBALS.masonViewerSVG.rect(this.configDisplayOptions.ICON_EXPAND_ROW_WIDTH/2,this.configDisplayOptions.ROW_HEIGHT/2);q.attr({fill:{r:255,g:255,b:255},stroke:{r:255,g:0,b:0},"fill-opacity":0});q.move(this.configDisplayOptions.ICON_EXPAND_ROW_STARTING_POSITION+this.configDisplayOptions.ICON_EXPAND_ROW_WIDTH/4,m);var n=this.GLOBALS.masonViewerSVG.line(this.configDisplayOptions.ICON_EXPAND_ROW_STARTING_POSITION+this.configDisplayOptions.ICON_EXPAND_ROW_WIDTH/2,m+2,this.configDisplayOptions.ICON_EXPAND_ROW_STARTING_POSITION+this.configDisplayOptions.ICON_EXPAND_ROW_WIDTH/2,m+this.configDisplayOptions.ROW_HEIGHT/2-2).stroke({color:"#f06",width:1});var p=this.GLOBALS.masonViewerSVG.line(this.configDisplayOptions.ICON_EXPAND_ROW_STARTING_POSITION+(this.configDisplayOptions.ICON_EXPAND_ROW_WIDTH/4)+2,m+this.configDisplayOptions.ROW_HEIGHT/4,this.configDisplayOptions.ICON_EXPAND_ROW_STARTING_POSITION+this.configDisplayOptions.ICON_EXPAND_ROW_WIDTH-(this.configDisplayOptions.ICON_EXPAND_ROW_WIDTH/2)+(this.configDisplayOptions.ICON_EXPAND_ROW_WIDTH/4)-2,m+this.configDisplayOptions.ROW_HEIGHT/4).stroke({color:"#f06",width:1});q.attr("cursor","pointer");n.attr("cursor","pointer");p.attr("cursor","pointer");j.add(q);j.add(n);j.add(p);o.add(q);o.add(n);o.add(p);this.attachToolTipToJqueryHtmlNode($(q.node),function(s,r){$(s).html(l);return l});this.attachToolTipToJqueryHtmlNode($(n.node),function(s,r){$(s).html(l);return l});this.attachToolTipToJqueryHtmlNode($(p.node),function(s,r){$(s).html(l);return l})};b.prototype.addMouseOverToBlocks=function(i){var j=this;var h=this.getJQueryObjForRawSVGFromSVG_js_item(i);h.hover(function(k){var l=$(this);l.css({stroke:j.configDisplayOptions.BLOCK_HIGHLIGHT_BORDER_COLOR,"stroke-width":j.configDisplayOptions.BLOCK_HIGHLIGHT_BORDER_WIDTH});j.highlightBoxUnderEachRow(this.instance)},function(k){var l=$(this);l.css({stroke:"black","stroke-width":0});j.unhighlightBoxUnderEachRow(this.instance)})};b.prototype.addMouseOverToLinesInsideMainBox=function(j){var i=this;var h=this.getJQueryObjForRawSVGFromSVG_js_item(j);h.hover(function(k){i.highlightBoxUnderEachRow(this.instance)},function(k){i.unhighlightBoxUnderEachRow(this.instance)})};"use strict";b.prototype.clickShowHideToggleHiddenBlocksRow=function(x,u,w){var q=this;var p=$(w);var n=this.get$rowMainGroupFor$currentElement(p);var j=this.getProgramaticDataStorageFromJQueryItem(n);var r=j.getCreateHiddenBlocksIfNotCreatedCallback();r();var m=j.getHiddenBlocksForRowSet();if(m!==g&&m!==null){var s=j.getSVGRowXmainBlocksGROUP();var l=j.getHiddenBlocksHeight();var z=j.getSVGGroupExpansionIcon();var k=j.getMainBlocksBoxUnderEachRow();var v=j.getHiddenBlocksBoxUnderEachRow();var o=j.getGroupToMoveForExpansion();var t=true;if(o){t=false}if(j.getHiddenBlocksVisible()){m.hide();if(v!==g){v.hide()}if(k!==g){k.show()}if(s!==g){s.show()}z.show();var y=0;var i=function(){j.setHiddenBlocksVisible(false);var A={animateAdjustChildGroupOfRowsVerticalOffset:t,$rowMainGroup:n};q.adjustChildGroupOfRowsVerticalOffset(A);q.resizeOverallImageLength()};var h={SVGoGroupToMove:o,yToTransformTo:y,functionToRunAfterAnimate:i};if(o){this.animateTransformY(h)}else{i()}}else{if(s!==g){s.hide()}if(k!==g){k.hide()}var y=l;var i=function(){m.show();if(v!==g){v.show()}z.hide();j.setHiddenBlocksVisible(true);var A={animateAdjustChildGroupOfRowsVerticalOffset:t,$rowMainGroup:n};q.adjustChildGroupOfRowsVerticalOffset(A);q.resizeOverallImageLength()};var h={SVGoGroupToMove:o,yToTransformTo:y,functionToRunAfterAnimate:i};if(o){this.animateTransformY(h)}else{i()}}}return false};b.prototype.adjustChildGroupOfRowsVerticalOffset=function(n){var q=n.$rowMainGroup;var i=n.animateAdjustChildGroupOfRowsVerticalOffset;var m=this.get$groupOfRowsFor$currentElement(q);var l=this.getSVG_js_itemForJQueryObj(m);var o=this.getProgramaticDataStorageFromSVG_js_Item(l);var s=o.getNextProgramaticDataStorageGroupOfRows();if(s){var k=o.getFirstOutputRowSVGGroup();var r=0;while(k){var h=this.getProgramaticDataStorageFromSVG_js_Item(k);if(h.getHiddenBlocksVisible()){r+=h.getHiddenBlocksHeight()}k=h.getGroupToMoveForExpansion()}var p=s.getSVGGroup();if(i){var j={SVGoGroupToMove:p,yToTransformTo:r,functionToRunAfterAnimate:function(){}};this.animateTransformY(j)}else{p.transform({y:r})}}};"use strict";b.prototype.createMainLineHiddenBlocksIfNotCreatedCallbackCreator=function(k,h,j,i){var l=this;var m=function(){var n=j.getHiddenBlocksForRowSet();var p=j.getOutputRow();if(p!==g&&p!==null){var o=p.splitAnyEntries;if(o&&(n===g||n===null)){l.processHiddenBlocksForRow(p,h,j,i)}}};j.setCreateHiddenBlocksIfNotCreatedCallback(m)};b.prototype.precomputeValuesOnCreateForMainRows=function(h){var l=this;for(var j=0;j<h.length;j++){var k=h[j];if(k.callbackDataStorage===g){k.callbackDataStorage={}}if(l.constructorParams.callbackFunctionsObj.rowTotalBar_callbackFunctions&&l.constructorParams.callbackFunctionsObj.rowTotalBar_callbackFunctions.precomputeValuesOnCreate){var i={rowItem:k.inputRowItem,callbackDataStorage:k.callbackDataStorage};l.constructorParams.callbackFunctionsObj.rowTotalBar_callbackFunctions.precomputeValuesOnCreate(i)}}};b.prototype.processRowTotalBlockForRow=function(h,o,l){var n=this;if((!n.constructorParams.callbackFunctionsObj.rowTotalBar_callbackFunctions)||(!n.constructorParams.callbackFunctionsObj.rowTotalBar_callbackFunctions.getColorAndSize)){return}var i={rowItem:h.inputRowItem,callbackDataStorage:h.callbackDataStorage};
var m=n.constructorParams.callbackFunctionsObj.rowTotalBar_callbackFunctions.getColorAndSize(i);var t=(l*this.configDisplayOptions.ROW_HEIGHT);t=t+this.configDisplayOptions.TOP_ROW_OFFSET_FROM_TOP_OF_IMAGE;var s=m.blockSize;if(s>0){var q=m.colorForBlock;var k=this.convertBlockColorTo_SVGJS_FillColor(q);var p=s*this.configDisplayOptions.ROW_TOTALS_BAR_RIGHT_MAX_WIDTH;if(p<this.configDisplayOptions.ROW_TOTAL_BLOCK_MINIMUM_SIZE){p=this.configDisplayOptions.ROW_TOTAL_BLOCK_MINIMUM_SIZE}var j=this.GLOBALS.masonViewerSVG.rect(p,this.configDisplayOptions.BLOCK_HEIGHT).attr({fill:k});j.move(this.GLOBALS.rowTotalsBarRightStartingPoint,t);this.addProgramaticDataStorageToSVG_js_Item(j);j.data("row-rowIdx",l);j.data("placement","row total blocks");o.add(j)}var r=this.GLOBALS.masonViewerSVG.rect(this.configDisplayOptions.ROW_TOTALS_BAR_RIGHT_MAX_WIDTH,this.configDisplayOptions.BLOCK_HEIGHT).attr({fill:{r:255,g:255,b:255},stroke:{r:0,g:0,b:0},"stroke-width":0.3,"fill-opacity":0});r.move(this.GLOBALS.rowTotalsBarRightStartingPoint,t);this.addProgramaticDataStorageToSVG_js_Item(r);this.attachMouseOverRowTotalBlock(r,h);this.attachClickHandlerRowTotalBlock(r,h);r.data("row-rowIdx",l);r.data("placement","row total blocks");o.add(r)};b.prototype.attachMouseOverMainRowLabel=function(i,j){var l=this;if((!l.constructorParams.callbackFunctionsObj.mainRowsLabel_callbackFunctions)||(!l.constructorParams.callbackFunctionsObj.mainRowsLabel_callbackFunctions.getToolTipText)){return}var k=this.getJQueryObjForRawSVGFromSVG_js_item(i);var h={rowItem:j.inputRowItem,callbackDataStorage:j.callbackDataStorage};this.attachToolTipToJqueryHtmlNode(k,function(o,n){var m=l.constructorParams.callbackFunctionsObj.mainRowsLabel_callbackFunctions.getToolTipText(h);$(o).html(m);return m})};b.prototype.attachClickHandlerMainRowLabel=function(h,j){var l=this;if(l.constructorParams.callbackFunctionsObj===g||l.constructorParams.callbackFunctionsObj.mainRowsLabel_callbackFunctions===g||l.constructorParams.callbackFunctionsObj.mainRowsLabel_callbackFunctions.processClick===g){return}var k=this.getJQueryObjForRawSVGFromSVG_js_item(h);var i={rowItem:j.inputRowItem,callbackDataStorage:j.callbackDataStorage};k.click(function(m){l.constructorParams.callbackFunctionsObj.mainRowsLabel_callbackFunctions.processClick(i)})};b.prototype.processLabelForRow=function(h,m,i){var j=this;var k=h.label;var p=this.GLOBALS.masonViewerSVG.text(k);this.addProgramaticDataStorageToSVG_js_Item(p);p.data("row-rowIdx",i);m.add(p);this.clearStyleAnd_dy_OnSVGtextItem(p);var n=(i*this.configDisplayOptions.ROW_HEIGHT)+(this.configDisplayOptions.ROW_HEIGHT/2);n=n+this.configDisplayOptions.TOP_ROW_OFFSET_FROM_TOP_OF_IMAGE;var l="";if(j.constructorParams.callbackFunctionsObj.mainRowsLabel_callbackFunctions&&j.constructorParams.callbackFunctionsObj.mainRowsLabel_callbackFunctions.processClick){l="; cursor: pointer;"}this.setSVGTextPosition({textSVG:p,x:this.configDisplayOptions.LABEL_STARTING_POSITION,y:n,otherAttrsToSet:g,additionalStyle:l});var o=(i*this.configDisplayOptions.ROW_HEIGHT);o=o+this.configDisplayOptions.TOP_ROW_OFFSET_FROM_TOP_OF_IMAGE;if(j.constructorParams.callbackFunctionsObj.mainRowsLabel_callbackFunctions&&j.constructorParams.callbackFunctionsObj.mainRowsLabel_callbackFunctions.precomputeValuesOnCreate){var q={callbackDataStorage:h.callbackDataStorage,rowItem:h.inputRowItem};j.constructorParams.callbackFunctionsObj.mainRowsLabel_callbackFunctions.precomputeValuesOnCreate(q)}if(j.constructorParams.callbackFunctionsObj.mainRowsLabel_callbackFunctions&&j.constructorParams.callbackFunctionsObj.mainRowsLabel_callbackFunctions.getToolTipText){this.attachMouseOverMainRowLabel(p,h)}if(j.constructorParams.callbackFunctionsObj.mainRowsLabel_callbackFunctions&&j.constructorParams.callbackFunctionsObj.mainRowsLabel_callbackFunctions.processClick){this.attachClickHandlerMainRowLabel(p,h)}return p};b.prototype.attachMouseOverBlockNonOverlappingBlocksRow=function(o,l,k){var m=this;if(m.constructorParams.callbackFunctionsObj===g||m.constructorParams.callbackFunctionsObj.mainRowsBlocks_callbackFunctions===g||m.constructorParams.callbackFunctionsObj.mainRowsBlocks_callbackFunctions.getNonOverlappingBlocksToolTipText===g){return}var j=this.getJQueryObjForRawSVGFromSVG_js_item(o);var h={startPos:l.blockStartPos,endPos:l.blockEndPos,blockDataItems:l.blockDataItems,rowItem:k.inputRowItem,callbackDataStorage:l.callbackDataStorage};var n=function(r,q){var p=m.constructorParams.callbackFunctionsObj.mainRowsBlocks_callbackFunctions.getNonOverlappingBlocksToolTipText(h);$(r).html(p);return p};var i={mouseenter:function(p){m.callListenersForBlockMouseEnter({node:p,blockInfo:h})},mouseleave:function(p){m.callListenersForBlockMouseLeave({node:p,blockInfo:h})}};this.attachToolTipToJqueryHtmlNode(j,n,i)};b.prototype.attachMouseOverBlockOverlappingBlocksRow=function(o,l,k){var m=this;if(m.constructorParams.callbackFunctionsObj===g||m.constructorParams.callbackFunctionsObj.mainRowsBlocks_callbackFunctions===g||m.constructorParams.callbackFunctionsObj.mainRowsBlocks_callbackFunctions.getOverlappingBlocksToolTipText===g){return}var j=this.getJQueryObjForRawSVGFromSVG_js_item(o);var h={startPos:l.blockStartPos,endPos:l.blockEndPos,blockDataItems:l.blockDataItems,rowItem:k.inputRowItem,callbackDataStorage:l.callbackDataStorage};var n=function(r,q){var p=m.constructorParams.callbackFunctionsObj.mainRowsBlocks_callbackFunctions.getOverlappingBlocksToolTipText(h);$(r).html(p);return p};var i={mouseenter:function(p){m.callListenersForBlockMouseEnter({node:p,blockInfo:h})},mouseleave:function(p){m.callListenersForBlockMouseLeave({node:p,blockInfo:h})}};this.attachToolTipToJqueryHtmlNode(j,n,i)};b.prototype.attachClickHandlerBlockNonOverlappingBlocks=function(m,k,j){var l=this;if(l.constructorParams.callbackFunctionsObj===g||l.constructorParams.callbackFunctionsObj.mainRowsBlocks_callbackFunctions===g||l.constructorParams.callbackFunctionsObj.mainRowsBlocks_callbackFunctions.processClick===g){return
}var i=this.getJQueryObjForRawSVGFromSVG_js_item(m);var h={startPos:k.blockStartPos,endPos:k.blockEndPos,blockDataItems:k.blockDataItems,rowItem:j.inputRowItem,callbackDataStorage:k.callbackDataStorage};i.click(function(n){l.constructorParams.callbackFunctionsObj.mainRowsBlocks_callbackFunctions.processClick(h)})};b.prototype.attachMouseOverRowTotalBlock=function(h,k){var l=this;if((!l.constructorParams.callbackFunctionsObj.rowTotalBar_callbackFunctions)||(!l.constructorParams.callbackFunctionsObj.rowTotalBar_callbackFunctions.getTotalBarToolTipText)){return}var i=this.getJQueryObjForRawSVGFromSVG_js_item(h);var j={rowItem:k.inputRowItem,callbackDataStorage:k.callbackDataStorage};this.attachToolTipToJqueryHtmlNode(i,function(o,n){var m=l.constructorParams.callbackFunctionsObj.rowTotalBar_callbackFunctions.getTotalBarToolTipText(j);$(o).html(m);return m})};b.prototype.attachClickHandlerRowTotalBlock=function(h,k){var l=this;if(l.constructorParams.callbackFunctionsObj===g||l.constructorParams.callbackFunctionsObj.rowTotalBar_callbackFunctions===g||l.constructorParams.callbackFunctionsObj.rowTotalBar_callbackFunctions.processClick===g){return}var j=this.getJQueryObjForRawSVGFromSVG_js_item(h);var i={rowItem:k.inputRowItem,callbackDataStorage:k.callbackDataStorage};j.click(function(m){l.constructorParams.callbackFunctionsObj.rowTotalBar_callbackFunctions.processClick(i)})};b.prototype.getHiddenBlocksForRow=function(m){var t=[];var s=[];var v=[];var z=-1;var i=m.blockItems;for(var j=0;j<i.length;j++){var w=i[j];var y=w;var o=y.blockStartPos;var n=y.blockEndPos;var l=this.positionLeftEdgeToPixel(o);var k=this.positionRightEdgeToPixel(n);for(var r=0;r<=z;r++){if(w.blockStartPos===(s[r]+1)){l=v[r]+0.01}}w.blockStartPositionPixel=l;w.blockEndPositionPixel=k;var u=false;for(var p=0;p<t.length;p++){var q=t[p];var h=q[q.length-1];if(l>(h.blockEndPositionPixel)){u=true;q.push(w);break}}if(!u){var x=[];x.push(w);t.push(x)}z++;s[z]=w.blockEndPos;v[z]=k}return t};b.prototype.processHiddenBlocksForRow=function(m,C,u,F){var w=this;if(!w.constructorParams.callbackFunctionsObj.mainRowsBlocks_callbackFunctions||!w.constructorParams.callbackFunctionsObj.mainRowsBlocks_callbackFunctions.precomputeValuesOnCreate){throw"callback function mainRowsBlocks_callbackFunctions.precomputeValuesOnCreate is missing"}var G=this.GLOBALS.masonViewerSVG.group();G.attr("label","groupOfHiddenBlocksForRow");C.add(G);u.setHiddenBlocksForRowSet(G);var z=this.getHiddenBlocksForRow(m);var H=(z.length-1)*this.configDisplayOptions.ROW_HEIGHT;u.setHiddenBlocksHeight(H);var o=H+this.configDisplayOptions.ROW_HEIGHT;this.addHiddenBlocksBoxUnderEachRowForMouseOver(o,G,u,F);for(var p=0;p<z.length;p++){var s=z[p];var n=s;for(var B=0;B<n.length;B++){var E=n[B];E.callbackDataStorage={};var h={rowItem:m.inputRowItem,blockDataItems:E.blockDataItems,startPos:E.blockStartPos,endPos:E.blockEndPos,callbackDataStorage:E.callbackDataStorage,splitAnyEntriesForRow:false,forHiddenBlocks:true};w.constructorParams.callbackFunctionsObj.mainRowsBlocks_callbackFunctions.precomputeValuesOnCreate(h);var v=E.blockStartPositionPixel+this.configDisplayOptions.MAIN_BOX_STARTING_POSITION;if(v<this.configDisplayOptions.MAIN_BOX_STARTING_POSITION){v=this.configDisplayOptions.MAIN_BOX_STARTING_POSITION}var t=((p)*this.configDisplayOptions.ROW_HEIGHT)+(F*this.configDisplayOptions.ROW_HEIGHT);t=t+this.configDisplayOptions.TOP_ROW_OFFSET_FROM_TOP_OF_IMAGE;var j=E.blockEndPositionPixel-E.blockStartPositionPixel;var l={rowItem:m.inputRowItem,blockDataItems:E.blockDataItems,callbackDataStorage:E.callbackDataStorage,forHiddenBlocks:true};var i=w.constructorParams.callbackFunctionsObj.mainRowsBlocks_callbackFunctions.getColorForBlock(l);var q=this.convertBlockColorTo_SVGJS_FillColor(i);var A=this.GLOBALS.masonViewerSVG.rect(j,this.configDisplayOptions.BLOCK_HEIGHT).attr({fill:q});A.move(v,t);this.addMouseOverToBlocks(A);this.addProgramaticDataStorageToSVG_js_Item(A);A.data("row-rowIdx",F);A.data("placement","initially hidden row blocks");A.data("block-id",E.id);this.attachMouseOverBlockNonOverlappingBlocksRow(A,E,m);this.attachClickHandlerBlockNonOverlappingBlocks(A,E,m);G.add(A)}}var r=m.vertLinesItems;this.processHiddenLinesForRowVerticalLines(r,z,G,F);this.showHideAllVerticalDataLinesPer_GLOBALS_showVerticalDataLines();var D=this.GLOBALS.masonViewerSVG.line(this.GLOBALS.leftLineX,((F)*this.configDisplayOptions.ROW_HEIGHT)+this.configDisplayOptions.TOP_ROW_OFFSET_FROM_TOP_OF_IMAGE,this.GLOBALS.leftLineX,(((F+1)*this.configDisplayOptions.ROW_HEIGHT)+H)+this.configDisplayOptions.TOP_ROW_OFFSET_FROM_TOP_OF_IMAGE).stroke({color:this.configDisplayOptions.BORDER_COLOR,width:this.configDisplayOptions.BORDER_WIDTH});var k=this.GLOBALS.masonViewerSVG.line(this.GLOBALS.rightLineX,((F)*this.configDisplayOptions.ROW_HEIGHT)+this.configDisplayOptions.TOP_ROW_OFFSET_FROM_TOP_OF_IMAGE,this.GLOBALS.rightLineX,(((F+1)*this.configDisplayOptions.ROW_HEIGHT)+H)+this.configDisplayOptions.TOP_ROW_OFFSET_FROM_TOP_OF_IMAGE).stroke({color:this.configDisplayOptions.BORDER_COLOR,width:this.configDisplayOptions.BORDER_WIDTH});D.data("placement","lines with initially hidden row blocks");k.data("placement","lines with initially hidden row blocks");G.add(D);G.add(k);this.createHiddenBlocksContractionIcon(this.configDisplayOptions.CLICK_TO_CONTRACT_TO_HIDE_INDIVIDUAL_BLOCKS_TOOLTIP_TEXT,G,F,u)};b.prototype.processHiddenLinesForRowVerticalLines=function(n,k,h,r){var j=this;if(n&&n.length>0&&j.constructorParams.callbackFunctionsObj.mainRowsVerticalLines_callbackFunctions&&j.constructorParams.callbackFunctionsObj.mainRowsVerticalLines_callbackFunctions.getColorForLine){for(var o=0;o<k.length;o++){for(var m=0;m<n.length;m++){var l=n[m];l.callbackDataStorage={};if(j.constructorParams.callbackFunctionsObj.mainRowsVerticalLines_callbackFunctions&&j.constructorParams.callbackFunctionsObj.mainRowsVerticalLines_callbackFunctions.precomputeValuesOnCreate){var w={vertLineData:l.vertLineData,linePos:l.linePos,forHiddenLines:true,callbackDataStorage:l.callbackDataStorage};
j.constructorParams.callbackFunctionsObj.mainRowsVerticalLines_callbackFunctions.precomputeValuesOnCreate(w)}var u=l.linePos;var q=this.positionCharPositionToPixel(u);var t=q+this.configDisplayOptions.MAIN_BOX_STARTING_POSITION;var s=((o)*this.configDisplayOptions.ROW_HEIGHT)+(r*this.configDisplayOptions.ROW_HEIGHT);s=s+this.configDisplayOptions.TOP_ROW_OFFSET_FROM_TOP_OF_IMAGE;var v={vertLineData:l.vertLineData,callbackDataStorage:l.callbackDataStorage,forHiddenLines:true};var z=j.constructorParams.callbackFunctionsObj.mainRowsVerticalLines_callbackFunctions.getColorForLine(v);this.isValidColor(z);var p=this.GLOBALS.masonViewerSVG.line(t,s,t,s+this.configDisplayOptions.BLOCK_HEIGHT).stroke({color:z,width:this.configDisplayOptions.BORDER_WIDTH});this.GLOBALS.setSVGVerticalDataLines.add(p);this.addMouseOverToLinesInsideMainBox(p);this.addProgramaticDataStorageToSVG_js_Item(p);p.data("rowOffset_hiddenBlockRowIdx",r+"_"+o);p.data("placement","primary row lines");p.data("block-id",l.id);var i={verticalLineSVG:p,lineData:l,callbackFunctions:j.constructorParams.callbackFunctionsObj.mainRowsVerticalLines_callbackFunctions};this.attachMouseOverVerticalLine(i);h.add(p)}}}};b.prototype.processMainLineBlocksForRow=function(p,D,C,l){var A=this;if(!A.constructorParams.callbackFunctionsObj.mainRowsBlocks_callbackFunctions||!A.constructorParams.callbackFunctionsObj.mainRowsBlocks_callbackFunctions.precomputeValuesOnCreate){throw"callback function mainRowsBlocks_callbackFunctions.precomputeValuesOnCreate is missing"}if(!A.constructorParams.callbackFunctionsObj.mainRowsBlocks_callbackFunctions||!A.constructorParams.callbackFunctionsObj.mainRowsBlocks_callbackFunctions.getColorForBlock){throw"callback function mainRowsBlocks_callbackFunctions.getColorForBlock is missing"}var G=p.mainLineBlocks;if(G.length>0){var v=p.splitAnyEntries;for(var u=0;u<G.length;u++){var F=G[u];F.callbackDataStorage={};var h={rowItem:p.inputRowItem,blockDataItems:F.blockDataItems,startPos:F.blockStartPos,endPos:F.blockEndPos,callbackDataStorage:F.callbackDataStorage,splitAnyEntriesForRow:v,forHiddenBlocks:false};A.constructorParams.callbackFunctionsObj.mainRowsBlocks_callbackFunctions.precomputeValuesOnCreate(h);var r=F.blockStartPos;var q=F.blockEndPos;var o=this.positionLeftEdgeToPixel(r);var k=this.positionRightEdgeToPixel(q);var j=k-o;var z=o+this.configDisplayOptions.MAIN_BOX_STARTING_POSITION;var w=(l*this.configDisplayOptions.ROW_HEIGHT)+this.configDisplayOptions.TOP_ROW_OFFSET_FROM_TOP_OF_IMAGE;var n={rowItem:p.inputRowItem,blockDataItems:F.blockDataItems,callbackDataStorage:F.callbackDataStorage,forHiddenBlocks:false};var i=A.constructorParams.callbackFunctionsObj.mainRowsBlocks_callbackFunctions.getColorForBlock(n);var s=this.convertBlockColorTo_SVGJS_FillColor(i);var B=this.GLOBALS.masonViewerSVG.rect(j,this.configDisplayOptions.BLOCK_HEIGHT).attr({fill:s});B.move(z,w);this.addMouseOverToBlocks(B);this.addProgramaticDataStorageToSVG_js_Item(B);B.data("row-rowIdx",l);B.data("placement","primary row blocks");B.data("block-id",F.id);if(v){this.attachMouseOverBlockOverlappingBlocksRow(B,F,p)}else{this.attachMouseOverBlockNonOverlappingBlocksRow(B,F,p);this.attachClickHandlerBlockNonOverlappingBlocks(B,F,p)}C.add(B)}}var t=p.vertLinesItems;this.processMainLineVerticalLines(t,C,l);var E=this.GLOBALS.masonViewerSVG.line(this.GLOBALS.leftLineX,(l*this.configDisplayOptions.ROW_HEIGHT)+this.configDisplayOptions.TOP_ROW_OFFSET_FROM_TOP_OF_IMAGE,this.GLOBALS.leftLineX,((l+1)*this.configDisplayOptions.ROW_HEIGHT)+this.configDisplayOptions.TOP_ROW_OFFSET_FROM_TOP_OF_IMAGE).stroke({color:this.configDisplayOptions.BORDER_COLOR,width:this.configDisplayOptions.BORDER_WIDTH});var m=this.GLOBALS.masonViewerSVG.line(this.GLOBALS.rightLineX,(l*this.configDisplayOptions.ROW_HEIGHT)+this.configDisplayOptions.TOP_ROW_OFFSET_FROM_TOP_OF_IMAGE,this.GLOBALS.rightLineX,((l+1)*this.configDisplayOptions.ROW_HEIGHT)+this.configDisplayOptions.TOP_ROW_OFFSET_FROM_TOP_OF_IMAGE).stroke({color:this.configDisplayOptions.BORDER_COLOR,width:this.configDisplayOptions.BORDER_WIDTH});E.data("placement","lines with primary row blocks");m.data("placement","lines with primary row blocks");D.add(E);D.add(m)};b.prototype.processMainLineVerticalLines=function(m,p,h){var j=this;if(m&&m.length>0&&j.constructorParams.callbackFunctionsObj.mainRowsVerticalLines_callbackFunctions&&j.constructorParams.callbackFunctionsObj.mainRowsVerticalLines_callbackFunctions.getColorForLine){for(var l=0;l<m.length;l++){var k=m[l];k.callbackDataStorage={};if(j.constructorParams.callbackFunctionsObj.mainRowsVerticalLines_callbackFunctions&&j.constructorParams.callbackFunctionsObj.mainRowsVerticalLines_callbackFunctions.precomputeValuesOnCreate){var u={vertLineData:k.vertLineData,linePos:k.linePos,forHiddenLines:false,callbackDataStorage:k.callbackDataStorage};j.constructorParams.callbackFunctionsObj.mainRowsVerticalLines_callbackFunctions.precomputeValuesOnCreate(u)}var s=k.linePos;var o=this.positionCharPositionToPixel(s);var r=o+this.configDisplayOptions.MAIN_BOX_STARTING_POSITION;var q=(h*this.configDisplayOptions.ROW_HEIGHT)+this.configDisplayOptions.TOP_ROW_OFFSET_FROM_TOP_OF_IMAGE;var t={vertLineData:k.vertLineData,callbackDataStorage:k.callbackDataStorage,forHiddenLines:false};var v=j.constructorParams.callbackFunctionsObj.mainRowsVerticalLines_callbackFunctions.getColorForLine(t);this.isValidColor(v);var n=this.GLOBALS.masonViewerSVG.line(r,q,r,q+this.configDisplayOptions.BLOCK_HEIGHT).stroke({color:v,width:this.configDisplayOptions.BORDER_WIDTH});this.GLOBALS.setSVGVerticalDataLines.add(n);this.addMouseOverToLinesInsideMainBox(n);this.addProgramaticDataStorageToSVG_js_Item(n);n.data("row-rowIdx",h);n.data("placement","primary row lines");n.data("block-id",k.id);var i={verticalLineSVG:n,lineData:k,callbackFunctions:j.constructorParams.callbackFunctionsObj.mainRowsVerticalLines_callbackFunctions};this.attachMouseOverVerticalLine(i);p.add(n)}}};"use strict";b.prototype.positionLeftEdgeToPixel=function(i){i-=0.5;
var h=this.positionPrivateCharPosToPixel(i);return h};b.prototype.positionRightEdgeToPixel=function(i){i+=0.5;var h=this.positionPrivateCharPosToPixel(i);return h};b.prototype.positionCharPositionToPixel=function(i){var h=this.positionPrivateCharPosToPixel(i);return h};b.prototype.positionPrivateCharPosToPixel=function(i){i=this.limitCharPositionMaxSeqLength(i);i-=0.5;var h=(i*this.GLOBALS.sequenceMultiplier);return h};b.prototype.limitCharPositionMaxSeqLength=function(h){var j=0.5;var i=this.constructorParams.requestParams.inputData.maxSequenceLength+0.5;if(h<j){h=j}else{if(h>i){h=i}}return h};"use strict";b.prototype.attachMouseOverBlockTotalsOverlappingBlocksRow=function(n,k){var l=this;if(l.constructorParams.callbackFunctionsObj===g||l.constructorParams.callbackFunctionsObj.combinedRow_callbackFunctions===g||l.constructorParams.callbackFunctionsObj.combinedRow_callbackFunctions.getBlocksToolTipText===g){return}var j=this.getJQueryObjForRawSVGFromSVG_js_item(n);var h={startPos:k.blockStartPos,endPos:k.blockEndPos,blockDataItems:k.blockDataItems,callbackDataStorage:k.callbackDataStorage};var m=function(q,p){var o=l.constructorParams.callbackFunctionsObj.combinedRow_callbackFunctions.getBlocksToolTipText(h);$(q).html(o);return o};var i={mouseenter:function(o){l.callListenersForBlockMouseEnter({node:o,blockInfo:h})},mouseleave:function(o){l.callListenersForBlockMouseLeave({node:o,blockInfo:h})}};this.attachToolTipToJqueryHtmlNode(j,m,i)};b.prototype.attachMouseOverBlockTotalsNonOverlappingBlocksRow=function(n,k){var l=this;if(l.constructorParams.callbackFunctionsObj===g||l.constructorParams.callbackFunctionsObj.combinedRow_callbackFunctions===g||l.constructorParams.callbackFunctionsObj.combinedRow_callbackFunctions.getBlocksToolTipText===g){return}var j=this.getJQueryObjForRawSVGFromSVG_js_item(n);var h={startPos:k.blockStartPos,endPos:k.blockEndPos,blockDataItems:k.blockDataItems,callbackDataStorage:k.callbackDataStorage};var m=function(q,p){var o=l.constructorParams.callbackFunctionsObj.combinedRow_callbackFunctions.getBlocksToolTipText(h);$(q).html(o);return o};var i={mouseenter:function(o){l.callListenersForBlockMouseEnter({node:o,blockInfo:h})},mouseleave:function(o){l.callListenersForBlockMouseLeave({node:o,blockInfo:h})}};this.attachToolTipToJqueryHtmlNode(j,m,i)};b.prototype.attachClickHandlerBlockCombinedRow=function(l,j){var k=this;if(k.constructorParams.callbackFunctionsObj===g||k.constructorParams.callbackFunctionsObj.combinedRow_callbackFunctions===g||k.constructorParams.callbackFunctionsObj.combinedRow_callbackFunctions.processClick===g){return}var i=this.getJQueryObjForRawSVGFromSVG_js_item(l);var h={startPos:j.blockStartPos,endPos:j.blockEndPos,blockDataItems:j.blockDataItems,callbackDataStorage:j.callbackDataStorage};i.click(function(m){k.constructorParams.callbackFunctionsObj.combinedRow_callbackFunctions.processClick(h)})};b.prototype.attachMouseOverCombinedRowTotalBlock=function(i,h){var k=this;if(k.constructorParams.callbackFunctionsObj===g||k.constructorParams.callbackFunctionsObj.combinedRowTotalBar_callbackFunctions===g||k.constructorParams.callbackFunctionsObj.combinedRowTotalBar_callbackFunctions.getTotalBarToolTipText===g){return}var j=this.getJQueryObjForRawSVGFromSVG_js_item(i);var l={callbackDataStorage:h};this.attachToolTipToJqueryHtmlNode(j,function(o,n){var m=k.constructorParams.callbackFunctionsObj.combinedRowTotalBar_callbackFunctions.getTotalBarToolTipText(l);$(o).html(m);return m})};b.prototype.attachClickHandlerCombinedRowTotalBlock=function(i,h){var l=this;if(l.constructorParams.callbackFunctionsObj===g||l.constructorParams.callbackFunctionsObj.combinedRowTotalBar_callbackFunctions===g||l.constructorParams.callbackFunctionsObj.combinedRowTotalBar_callbackFunctions.processClick===g){return}var k=this.getJQueryObjForRawSVGFromSVG_js_item(i);var j={callbackDataStorage:h};k.click(function(m){l.constructorParams.callbackFunctionsObj.combinedRowTotalBar_callbackFunctions.processClick(j)})};b.prototype.processCombinedRow=function(k,h,j,i){j.attr("class","prot_cov_viewer_group_row_main");j.attr("label","Totals Row Group");var l=this.combineTotalsBlocksWhereStartEndMatch(k);var q=this.constructorParams.objectThisMasonViewerPerInstance.combineOverlapsProteinPositionBased(l);var p=q.splitAnyEntries;var o=q.outputList;this.processTotalsLabel(h,p,j,i);this.addBoxUnderEachRowForMouseOver(j,i,h);var n={mainLineTotalBlocks:o,combinedBlockItems:l,splitAnyEntries:p};var m=this.GLOBALS.masonViewerSVG.group();j.add(m);m.attr("label","SVGRowXmainBlocksGROUP_processCombinedRow");i.setSVGRowXmainBlocksGROUP(m);this.processCombinedRowMainLineBlocks(n,j,m,h);if(p){this.createTotalsLineHiddenBlocksIfNotCreatedCallbackCreator(h,l,q.splitAnyEntries,j,i)}this.processRowTotalBlockForCombinedRow(h,j,i)};b.prototype.createTotalsLineHiddenBlocksIfNotCreatedCallbackCreator=function(k,j,l,h,i){var m=this;var n=function(){var o=i.getHiddenBlocksForRowSet();if(l&&(o===g||o===null)){m.processCombinedRowHiddenBlocks(k,j,l,h,i)}};i.setCreateHiddenBlocksIfNotCreatedCallback(n)};b.prototype.processTotalsLabel=function(i,s,n,j){var k=this;var l=this.configDisplayOptions.combinedLineLabel;var r=this.GLOBALS.masonViewerSVG.text(l);this.addProgramaticDataStorageToSVG_js_Item(r);r.data("Totals-Label","");n.add(r);k.clearStyleAnd_dy_OnSVGtextItem(r);var o=(i*this.configDisplayOptions.ROW_HEIGHT)+(this.configDisplayOptions.ROW_HEIGHT/2);o=o+this.configDisplayOptions.TOP_ROW_OFFSET_FROM_TOP_OF_IMAGE;var m="";this.setSVGTextPosition({textSVG:r,x:this.configDisplayOptions.LABEL_STARTING_POSITION,y:o,otherAttrsToSet:g,additionalStyle:m});var q=(i*this.configDisplayOptions.ROW_HEIGHT);q=q+this.configDisplayOptions.TOP_ROW_OFFSET_FROM_TOP_OF_IMAGE;if(this.configDisplayOptions.combinedLineTooltipHTML){var h=this.configDisplayOptions.combinedLineTooltipHTML;var p=this.getJQueryObjForRawSVGFromSVG_js_item(r);this.attachToolTipToJqueryHtmlNode(p,function(v,u){var t=h;$(v).html(t);return t})}if(s){this.createHiddenBlocksExpansionIcon(this.configDisplayOptions.CLICK_TO_EXPAND_TO_SHOW_INDIVIDUAL_BLOCKS_TOOLTIP_TEXT,n,i,j)
}};b.prototype.combineTotalsBlocksWhereStartEndMatch=function(l){var p=[];var i=[];for(var j=0;j<l.length;j++){var h=l[j];var q=h.blockItems;for(var n=0;n<q.length;n++){var o=q[n];i.push(o)}}for(var n=0;n<i.length;n++){var o=i[n];if(o!==null){for(var m=n+1;m<i.length;m++){var k=i[m];if(k!==null){if(o.blockStartPos===k.blockStartPos&&o.blockEndPos===k.blockEndPos){o.blockDataItems=o.blockDataItems.concat(k.blockDataItems);i[m]=null}}}p.push(o)}}p.sort(this.constructorParams.objectThisMasonViewerPerInstance.combineOverlaps_Z_compareForSortBlocks);return p};b.prototype.placeTotalsBlocksIntoRows=function(i){var u=[];var r=[];var v=[];var y=-1;for(var j=0;j<i.length;j++){var w=i[j];var x=w;var n=x.blockStartPos;var m=x.blockEndPos;var l=this.positionLeftEdgeToPixel(n);var k=this.positionRightEdgeToPixel(m);for(var q=0;q<=y;q++){if(w.blockStartPos===(r[q]+1)){l=v[q]+0.01}}w.totalBlockStartPositionPixel=l;w.totalBlockEndPositionPixel=k;var s=false;for(var o=0;o<u.length;o++){var p=u[o];var h=p[p.length-1];if(l>(h.totalBlockEndPositionPixel)){s=true;p.push(w);break}}if(!s){var t=[];t.push(w);u.push(t)}y++;r[y]=w.blockEndPos;v[y]=k}return u};b.prototype.processCombinedRowMainLineBlocks=function(q,D,C,l){var A=this;if(!A.constructorParams.callbackFunctionsObj.combinedRow_callbackFunctions||!A.constructorParams.callbackFunctionsObj.combinedRow_callbackFunctions.precomputeValuesOnCreate){throw"callback function combinedRow_callbackFunctions.precomputeValuesOnCreate is missing"}if(!A.constructorParams.callbackFunctionsObj.combinedRow_callbackFunctions||!A.constructorParams.callbackFunctionsObj.combinedRow_callbackFunctions.getColorForBlock){throw"callback function combinedRow_callbackFunctions.getColorForBlock is missing"}var G=q.mainLineTotalBlocks;if(G.length>0){var v=q.splitAnyEntries;for(var u=0;u<G.length;u++){var F=G[u];F.callbackDataStorage={};var h={blockDataItems:F.blockDataItems,startPos:F.blockStartPos,endPos:F.blockEndPos,splitAnyEntriesForRow:v,callbackDataStorage:F.callbackDataStorage};A.constructorParams.callbackFunctionsObj.combinedRow_callbackFunctions.precomputeValuesOnCreate(h);var s=F.blockStartPos;var r=F.blockEndPos;var p=this.positionLeftEdgeToPixel(s);var k=this.positionRightEdgeToPixel(r);var j=k-p;var z=p+this.configDisplayOptions.MAIN_BOX_STARTING_POSITION;var w=(l*this.configDisplayOptions.ROW_HEIGHT)+this.configDisplayOptions.TOP_ROW_OFFSET_FROM_TOP_OF_IMAGE;var o={blockDataItems:F.blockDataItems,callbackDataStorage:F.callbackDataStorage};var i=A.constructorParams.callbackFunctionsObj.combinedRow_callbackFunctions.getColorForBlock(o);var t=this.convertBlockColorTo_SVGJS_FillColor(i);var B=this.GLOBALS.masonViewerSVG.rect(j,this.configDisplayOptions.BLOCK_HEIGHT).attr({fill:t});B.move(z,w);this.addMouseOverToBlocks(B);this.addProgramaticDataStorageToSVG_js_Item(B);B.data("row-rowIdx",l);B.data("placement","primary row blocks");B.data("block-id",F.id);if(v){this.attachMouseOverBlockTotalsOverlappingBlocksRow(B,F,q)}else{this.attachMouseOverBlockTotalsNonOverlappingBlocksRow(B,F,q);this.attachClickHandlerBlockCombinedRow(B,F,q)}C.add(B)}}var n=this.constructorParams.requestParams.inputData.vertLinesCombinedRow;this.processCombinedRowMainLineVerticalLines(n,C,l);var E=this.GLOBALS.masonViewerSVG.line(this.GLOBALS.leftLineX,(l*this.configDisplayOptions.ROW_HEIGHT)+this.configDisplayOptions.TOP_ROW_OFFSET_FROM_TOP_OF_IMAGE,this.GLOBALS.leftLineX,((l+1)*this.configDisplayOptions.ROW_HEIGHT)+this.configDisplayOptions.TOP_ROW_OFFSET_FROM_TOP_OF_IMAGE).stroke({color:this.configDisplayOptions.BORDER_COLOR,width:this.configDisplayOptions.BORDER_WIDTH});var m=this.GLOBALS.masonViewerSVG.line(this.GLOBALS.rightLineX,(l*this.configDisplayOptions.ROW_HEIGHT)+this.configDisplayOptions.TOP_ROW_OFFSET_FROM_TOP_OF_IMAGE,this.GLOBALS.rightLineX,((l+1)*this.configDisplayOptions.ROW_HEIGHT)+this.configDisplayOptions.TOP_ROW_OFFSET_FROM_TOP_OF_IMAGE).stroke({color:this.configDisplayOptions.BORDER_COLOR,width:this.configDisplayOptions.BORDER_WIDTH});E.data("placement","left edge line for primary totals row blocks");m.data("placement","right edge line for primary totals row blocks");D.add(E);D.add(m)};b.prototype.processCombinedRowMainLineVerticalLines=function(i,o,h){var k=this;if(i&&i.length>0&&k.constructorParams.callbackFunctionsObj.combinedRowVerticalLines_callbackFunctions&&k.constructorParams.callbackFunctionsObj.combinedRowVerticalLines_callbackFunctions.getColorForLine){for(var q=0;q<i.length;q++){var l=i[q];l.callbackDataStorage={};if(k.constructorParams.callbackFunctionsObj.combinedRowVerticalLines_callbackFunctions&&k.constructorParams.callbackFunctionsObj.combinedRowVerticalLines_callbackFunctions.precomputeValuesOnCreate){var u={vertLineData:l.vertLineData,linePos:l.linePos,forHiddenLines:false,callbackDataStorage:l.callbackDataStorage};k.constructorParams.callbackFunctionsObj.combinedRowVerticalLines_callbackFunctions.precomputeValuesOnCreate(u)}var s=l.linePos;var n=this.positionCharPositionToPixel(s);var r=n+this.configDisplayOptions.MAIN_BOX_STARTING_POSITION;var p=(h*this.configDisplayOptions.ROW_HEIGHT)+this.configDisplayOptions.TOP_ROW_OFFSET_FROM_TOP_OF_IMAGE;var t={vertLineData:l.vertLineData,callbackDataStorage:l.callbackDataStorage,forHiddenLines:false};var v=k.constructorParams.callbackFunctionsObj.combinedRowVerticalLines_callbackFunctions.getColorForLine(t);this.isValidColor(v);var m=this.GLOBALS.masonViewerSVG.line(r,p,r,p+this.configDisplayOptions.BLOCK_HEIGHT).stroke({color:v,width:this.configDisplayOptions.BORDER_WIDTH});this.GLOBALS.setSVGVerticalDataLines.add(m);this.addProgramaticDataStorageToSVG_js_Item(m);m.data("row-rowIdx",h);m.data("placement","primary totals row lines");m.data("block-id",l.id);var j={verticalLineSVG:m,lineData:l,callbackFunctions:k.constructorParams.callbackFunctionsObj.combinedRowVerticalLines_callbackFunctions};this.attachMouseOverVerticalLine(j);o.add(m)}}};b.prototype.processCombinedRowHiddenBlocks=function(m,q,u,G,w){var B=this;if(!B.constructorParams.callbackFunctionsObj.combinedRow_callbackFunctions||!B.constructorParams.callbackFunctionsObj.combinedRow_callbackFunctions.precomputeValuesOnCreate){throw"callback function combinedRow_callbackFunctions.precomputeValuesOnCreate is missing"
}if(!B.constructorParams.callbackFunctionsObj.combinedRow_callbackFunctions||!B.constructorParams.callbackFunctionsObj.combinedRow_callbackFunctions.getColorForBlock){throw"callback function combinedRow_callbackFunctions.getColorForBlock is missing"}var l=this.GLOBALS.masonViewerSVG.group();G.add(l);l.attr("label","groupOfTotalsHiddenBlocksForRow_processCombinedRow");w.setHiddenBlocksForRowSet(l);var k=m*this.configDisplayOptions.ROW_HEIGHT;var D=this.placeTotalsBlocksIntoRows(q);var E=D.length*this.configDisplayOptions.ROW_HEIGHT;var t=(D.length-1)*this.configDisplayOptions.ROW_HEIGHT;w.setHiddenBlocksHeight(t);this.addTotalsBlocksBoxUnderEachRowForMouseOver(E,l,w,m);for(var H=0;H<D.length;H++){var r=D[H];var F=r;for(var A=0;A<F.length;A++){var J=F[A];J.callbackDataStorage={};var h={blockDataItems:J.blockDataItems,startPos:J.blockStartPos,endPos:J.blockEndPos,splitAnyEntriesForRow:false,forHiddenBlocks:true,callbackDataStorage:J.callbackDataStorage};B.constructorParams.callbackFunctionsObj.combinedRow_callbackFunctions.precomputeValuesOnCreate(h)}}for(var H=0;H<D.length;H++){var r=D[H];var F=r;for(var A=0;A<F.length;A++){var J=F[A];var z=J.totalBlockStartPositionPixel+this.configDisplayOptions.MAIN_BOX_STARTING_POSITION;if(z<this.configDisplayOptions.MAIN_BOX_STARTING_POSITION){z=this.configDisplayOptions.MAIN_BOX_STARTING_POSITION}var v=((H)*this.configDisplayOptions.ROW_HEIGHT)+(k);v=v+this.configDisplayOptions.TOP_ROW_OFFSET_FROM_TOP_OF_IMAGE;var j=J.totalBlockEndPositionPixel-J.totalBlockStartPositionPixel;var p={blockDataItems:J.blockDataItems,callbackDataStorage:J.callbackDataStorage};var i=B.constructorParams.callbackFunctionsObj.combinedRow_callbackFunctions.getColorForBlock(p);var s=this.convertBlockColorTo_SVGJS_FillColor(i);var C=this.GLOBALS.masonViewerSVG.rect(j,this.configDisplayOptions.BLOCK_HEIGHT).attr({fill:s});C.move(z,v);this.addMouseOverToBlocks(C);this.addProgramaticDataStorageToSVG_js_Item(C);C.data("row-rowIdx",m);C.data("placement","initially hidden total row blocks");C.data("block-id",J.id);this.attachMouseOverBlockTotalsNonOverlappingBlocksRow(C,J);this.attachClickHandlerBlockCombinedRow(C,J);G.add(C);l.add(C)}}var o=this.constructorParams.requestParams.inputData.vertLinesCombinedRow;this.processCombinedRowHiddenLinesVerticalLines(o,D,l,m);this.showHideAllVerticalDataLinesPer_GLOBALS_showVerticalDataLines();var I=this.GLOBALS.masonViewerSVG.line(this.GLOBALS.leftLineX,(k)+this.configDisplayOptions.TOP_ROW_OFFSET_FROM_TOP_OF_IMAGE,this.GLOBALS.leftLineX,((k)+E)+this.configDisplayOptions.TOP_ROW_OFFSET_FROM_TOP_OF_IMAGE).stroke({color:this.configDisplayOptions.BORDER_COLOR,width:this.configDisplayOptions.BORDER_WIDTH});var n=this.GLOBALS.masonViewerSVG.line(this.GLOBALS.rightLineX,(k)+this.configDisplayOptions.TOP_ROW_OFFSET_FROM_TOP_OF_IMAGE,this.GLOBALS.rightLineX,((k)+E)+this.configDisplayOptions.TOP_ROW_OFFSET_FROM_TOP_OF_IMAGE).stroke({color:this.configDisplayOptions.BORDER_COLOR,width:this.configDisplayOptions.BORDER_WIDTH});l.add(I);l.add(n);this.createHiddenBlocksContractionIcon(this.configDisplayOptions.CLICK_TO_CONTRACT_TO_HIDE_INDIVIDUAL_BLOCKS_TOOLTIP_TEXT,l,m,w);l.hide()};b.prototype.processCombinedRowHiddenLinesVerticalLines=function(i,j,r,h){var l=this;if(i&&i.length>0&&l.constructorParams.callbackFunctionsObj.combinedRowVerticalLines_callbackFunctions&&l.constructorParams.callbackFunctionsObj.combinedRowVerticalLines_callbackFunctions.getColorForLine){for(var o=0;o<j.length;o++){for(var s=0;s<i.length;s++){var m=i[s];m.callbackDataStorage={};if(l.constructorParams.callbackFunctionsObj.combinedRowVerticalLines_callbackFunctions&&l.constructorParams.callbackFunctionsObj.combinedRowVerticalLines_callbackFunctions.precomputeValuesOnCreate){var w={vertLineData:m.vertLineData,linePos:m.linePos,forHiddenLines:true,callbackDataStorage:m.callbackDataStorage};l.constructorParams.callbackFunctionsObj.combinedRowVerticalLines_callbackFunctions.precomputeValuesOnCreate(w)}var u=m.linePos;var p=this.positionCharPositionToPixel(u);var t=p+this.configDisplayOptions.MAIN_BOX_STARTING_POSITION;var q=((o)*this.configDisplayOptions.ROW_HEIGHT)+(h*this.configDisplayOptions.ROW_HEIGHT);q=q+this.configDisplayOptions.TOP_ROW_OFFSET_FROM_TOP_OF_IMAGE;var v={vertLineData:m.vertLineData,callbackDataStorage:m.callbackDataStorage,forHiddenLines:false};var z=l.constructorParams.callbackFunctionsObj.combinedRowVerticalLines_callbackFunctions.getColorForLine(v);this.isValidColor(z);var n=this.GLOBALS.masonViewerSVG.line(t,q,t,q+this.configDisplayOptions.BLOCK_HEIGHT).stroke({color:z,width:this.configDisplayOptions.BORDER_WIDTH});this.GLOBALS.setSVGVerticalDataLines.add(n);this.addMouseOverToLinesInsideMainBox(n);this.addProgramaticDataStorageToSVG_js_Item(n);n.data("rowIdx_combinedRowLinesIdx",h+"_"+s);n.data("placement","initally hidden totals row lines");n.data("block-id",m.id);var k={verticalLineSVG:n,lineData:m,callbackFunctions:l.constructorParams.callbackFunctionsObj.combinedRowVerticalLines_callbackFunctions};this.attachMouseOverVerticalLine(k);r.add(n)}}}};b.prototype.processRowTotalBlockForCombinedRow=function(k,o,m){var n=this;if(n.constructorParams.callbackFunctionsObj.combinedRowTotalBar_callbackFunctions===g||n.constructorParams.callbackFunctionsObj.combinedRowTotalBar_callbackFunctions===null){return}if(n.constructorParams.callbackFunctionsObj.combinedRowTotalBar_callbackFunctions.precomputeValuesOnCreate===g||n.constructorParams.callbackFunctionsObj.combinedRowTotalBar_callbackFunctions.precomputeValuesOnCreate===null){return}if(n.constructorParams.callbackFunctionsObj.combinedRowTotalBar_callbackFunctions.getColorAndSize===g||n.constructorParams.callbackFunctionsObj.combinedRowTotalBar_callbackFunctions.getColorAndSize===null){return}var r={};var v={callbackDataStorage:r};n.constructorParams.callbackFunctionsObj.combinedRowTotalBar_callbackFunctions.precomputeValuesOnCreate(v);var h={callbackDataStorage:r};var l=n.constructorParams.callbackFunctionsObj.combinedRowTotalBar_callbackFunctions.getColorAndSize(h);
var u=(k*this.configDisplayOptions.ROW_HEIGHT);u=u+this.configDisplayOptions.TOP_ROW_OFFSET_FROM_TOP_OF_IMAGE;var t=l.blockSize;if(t>0){var q=l.colorForBlock;var j=this.convertBlockColorTo_SVGJS_FillColor(q);var p=t*this.configDisplayOptions.ROW_TOTALS_BAR_RIGHT_MAX_WIDTH;if(p<this.configDisplayOptions.ROW_TOTAL_BLOCK_MINIMUM_SIZE){p=this.configDisplayOptions.ROW_TOTAL_BLOCK_MINIMUM_SIZE}var i=this.GLOBALS.masonViewerSVG.rect(p,this.configDisplayOptions.BLOCK_HEIGHT).attr({fill:j});i.move(this.GLOBALS.rowTotalsBarRightStartingPoint,u);this.addProgramaticDataStorageToSVG_js_Item(i);i.data("row-rowIdx",k);i.data("placement","totals row: row total blocks");o.add(i)}var s=this.GLOBALS.masonViewerSVG.rect(this.configDisplayOptions.ROW_TOTALS_BAR_RIGHT_MAX_WIDTH,this.configDisplayOptions.BLOCK_HEIGHT).attr({fill:{r:255,g:255,b:255},stroke:{r:0,g:0,b:0},"stroke-width":0.3,"fill-opacity":0});s.move(this.GLOBALS.rowTotalsBarRightStartingPoint,u);this.addProgramaticDataStorageToSVG_js_Item(s);this.attachMouseOverCombinedRowTotalBlock(s,r);this.attachClickHandlerCombinedRowTotalBlock(s,r);s.data("row-rowIdx",k);s.data("placement","totals row: row total blocks clear overlay");o.add(s)}})(window);